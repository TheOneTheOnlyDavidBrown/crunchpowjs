"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function loadComponent(e,t){return new window[e](t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),BaseModel=function(){function e(t,n){_classCallCheck(this,e),this.modelName=t,this.data=n}return _createClass(e,[{key:"set",value:function(e,t){var n=this._existsInSchema(this.data,e,t);if(!n)return void console.warn('Not setting "'+e+'" in '+this.modelName+' model to "'+t+'". Doesnt exist in the schema');var r=this._checkType(this.data,e,t);return r?void this._setValue(this.data,e,t):void console.warn('Not setting "'+e+'" in '+this.modelName+' model to "'+t+'". It isnt the right type')}},{key:"get",value:function(e){var t=void 0;return t=e?this._getValue(this.data,e):this._getData(this.data)}},{key:"_existsInSchema",value:function(e,t,n){var r=void 0,a="string"==typeof t?t.split("."):t;return r=a.length>1&&e[a[0]]?this._existsInSchema(e[a.shift()].value,a,n):!!e[a[0]]}},{key:"_checkType",value:function(e,t,n){var r=void 0,a="string"==typeof t?t.split("."):t;return r=a.length>1&&e[a[0]]?this._checkType(e[a.shift()].value,a,n):e[a[0]].type===typeof n}},{key:"_getData",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1];for(var n in e)"object"===e[n].type?(t[n]={},this._getData(e[n].value,t[n])):t[n]=e[n].value;return t}},{key:"_setValue",value:function(e,t,n){var r="string"==typeof t?t.split("."):t;r.length>1&&e[r[0]].value?this._setValue(e[r.shift()].value,r,n):e[r[0]].value&&(e[r[0]].value=n)}},{key:"_getValue",value:function(e,t){var n=void 0,r=t;return r="string"==typeof t?r.split("."):r,n=r.length>1&&e[r[0]]?this._getValue(e[r.shift()].value,r):e[r[0]].value||""}},{key:"_checkStatus",value:function(e){var t=void 0;if(!(e.status>=200&&e.status<300)){var n=new Error(e.statusText);throw n.response=e,n}return t=e}},{key:"_parseJSON",value:function(e){return e.json()}},{key:"save",value:function(){var e=arguments.length<=0||void 0===arguments[0]?this.get("id"):arguments[0],t=this.endpointPrefix+"/"+this.modelName+"/"+e,n={},r={method:"post",body:JSON.stringify(n)};return n[this.modelName]=this.get(),console.log("make post xhr call to "+t,n),fetch(t,r).then(this._checkStatus).then(this._parseJSON)}},{key:"fetch",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=arguments.length<=0||void 0===arguments[0]?this.get("id"):arguments[0],t=this.endpointPrefix+"/"+this.modelName+"/"+e,n={method:"get"};return console.log("make get xhr call to "+t),fetch(t,n).then(this._checkStatus).then(this._parseJSON)})},{key:"update",value:function(){var e=arguments.length<=0||void 0===arguments[0]?this.get("id"):arguments[0],t=this.endpointPrefix+"/"+this.modelName+"/"+e,n={};n[this.modelName]=this.get(),console.log("make update xhr call to "+t,n)}},{key:"destroy",value:function(){var e=arguments.length<=0||void 0===arguments[0]?this.get("id"):arguments[0],t=this.endpointPrefix+"/"+this.modelName+"/"+e,n={method:"delete"};return console.log("make delete xhr call to "+t),fetch(t,n).then(this._checkStatus).then(this._parseJSON)}},{key:"endpointPrefix",set:function(e){this._endpointPrefix=e},get:function(){return this._endpointPrefix||"api/vi"}}]),e}(),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();NodeList.prototype[Symbol.iterator]=Array.prototype[Symbol.iterator];var Binding=function(){function e(t){var n=this;_classCallCheck(this,e),this.data=t,this._findBindable(),this.utils=new Utils;var r=r||{};setInterval(function(){n.utils.compare(r,n.data)===!1&&(r=JSON.parse(JSON.stringify(n.data)),n._populateBindings())},10)}return _createClass(e,[{key:"_populateBindings",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,a=document.querySelectorAll("[liaison-bind]")[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var i=r.value,o=document.activeElement.getAttribute("liaison-bind");i===document.activeElement||i.getAttribute("liaison-bind")!==o&&null!==o||this._setElementContent(i,this._getValue(this.data,i.getAttribute("liaison-bind")))}}catch(s){t=!0,n=s}finally{try{!e&&a["return"]&&a["return"]()}finally{if(t)throw n}}}},{key:"_findBindable",value:function(){var e=this,t=!0,n=!1,r=void 0;try{for(var a,i=function(){var t=a.value;t.addEventListener("keydown",function(n){setTimeout(function(){return e._setValue(e.data,t.getAttribute("liaison-bind"),n.srcElement.value)})})},o=document.querySelectorAll("[liaison-bind]")[Symbol.iterator]();!(t=(a=o.next()).done);t=!0)i()}catch(s){n=!0,r=s}finally{try{!t&&o["return"]&&o["return"]()}finally{if(n)throw r}}}},{key:"_setElementContent",value:function(e,t){void 0!==t&&(e.innerHTML=t,e.value=t)}},{key:"_setValue",value:function(e,t,n){var r=t;"string"==typeof r&&(r=r.split(".")),r.length>1&&e[r[0]]?this._setValue(e[r.shift()],r,n):"string"==typeof e[r[0]]&&(e[r[0]]=n)}},{key:"_getValue",value:function(e,t){var n=t,r=void 0;return"string"==typeof n&&(n=n.split(".")),r=n.length>1&&e[n[0]]?this._getValue(e[n.shift()],n):e[n[0]]}},{key:"refresh",value:function(e){this.data=e,this._populateBindings()}}]),e}(),Liaison=function e(t){_classCallCheck(this,e);for(var n in t)n&&(this[n]=t[n])},_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Router=function(){function e(){var t=this;_classCallCheck(this,e),this.utils=new Utils,this.view=document.querySelector("[liaison-view]"),this.paths=[],this.wildcards=[],setTimeout(function(){return t.go(window.location.hash.substring(1))},0),window.addEventListener("popstate",function(e){return t.go(e.state||window.location.hash.substring(1),!1)})}return _createClass(e,[{key:"state",value:function(e){return e.name.indexOf(":")>0?this.wildcards.push(e):this.paths.push(e),this}},{key:"fallback",value:function(e){this.paths.push(e),this._fallback=e}},{key:"go",value:function(e){var t=this;console.log("going to state "+e);var n=this._findRouteInPaths(e);return n?void fetch(n.templateUrl).then(function(e){return e.text()}).then(function(e){t.view.innerHTML=e}):(this.go(this._fallback.name),!1)}},{key:"_findRouteInPaths",value:function(e){var t=this,n=!0,r=!1,a=void 0;try{for(var i,o=this.paths[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var s=i.value;if(s.name===e)return s}}catch(l){r=!0,a=l}finally{try{!n&&o["return"]&&o["return"]()}finally{if(r)throw a}}var u=void 0,c=this._parseRoute(e);return this.wildcards.filter(function(e){return t._parseRoute(e.name).length===c.length}).forEach(function(e){var n=t._parseRoute(e.name);n.forEach(function(r,a){if(0!==r.indexOf(":"))return!1;var i=n;i[a]=c[a],t.utils.compare(i,c)&&(u=e)})}),u}},{key:"_parseRoute",value:function(e){return e.substring(1).split("/")}}]),e}(),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Utils=function(){function e(){_classCallCheck(this,e)}return _createClass(e,[{key:"_hasher",value:function(e){var t=0,n=void 0,r=void 0,a=e.toString();for(n=0,r=a.length;r>n;n++)t=(t<<5)-t+a.charCodeAt(n)&4294967295;return t}},{key:"_object",value:function(e,t){var n=arguments.length<=2||void 0===arguments[2]?0:arguments[2],r=n;for(var a in t){if("object"==typeof t[a])return this._object(e,t[a],r);hasOwnProperty.call(t,a)&&(r+=e._hasher(a+e._hasher(t[a])))}return r}},{key:"hash",value:function(e){var t={string:this._hasher,number:this._hasher,"boolean":this._hasher,object:this.object},n=typeof e;return null!==e&&t[n]?t[n](this,e)+this._hasher(n):0}},{key:"compareHashes",value:function(e,t){return this.hash(e)===this.hash(t)}},{key:"compare",value:function(e,t){return JSON.stringify(e)===JSON.stringify(t)}}]),e}(),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Example=function(){function e(t){_classCallCheck(this,e),this.bind=new Liaison(t),console.log(this.bind),this.binding=new Binding(this.bind),this.exampleBinding(),this.exampleRouter()}return _createClass(e,[{key:"exampleBinding",value:function(){var e=new UserModel;e.set("age","8777"),e.set("name","my first name on user model"),e.set("age",{age:33}),e.set("age",999),e.set("address","my address"),e.set("address",e.upCase("my second address")),e.save().then(function(){console.log("then")})["catch"](function(e){console.log("request failed",e)}),e.update(),e.fetch().then(function(){console.log("then")})["catch"](function(e){console.log("request failed",e)}),e.destroy().then(function(){console.log("then")})["catch"](function(e){console.log("request failed",e)});var t=new ViewModel;t.set("single","updated via viewmodel model set function"),t.set("user.name","my second example name"),t.set("user.age",{age:22}),t.set("user.age",444),t.set("user.address",77878),t.set("user.address","my second address"),this.binding.refresh(this.bind)}},{key:"exampleRouter",value:function(){}}]),e}(),_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Example2=function(){function e(t){_classCallCheck(this,e),this.bind=new Liaison(t),this.binding=new Binding(this.bind)}return _createClass(e,[{key:"anotherFunction",value:function(){console.log(this.bind.string)}}]),e}();window.router=window.router||new Router,window.router.state({name:"/users",templateUrl:"templates/userindex.html"}).state({name:"/user/:id",templateUrl:"templates/user.html"}).state({name:"/user/:id/details",templateUrl:"templates/userdetails.html"}).state({name:"/user/:id/:subid",templateUrl:"templates/usersub.html"}).state({name:"/list",templateUrl:"templates/list.html"}).state({name:"/",templateUrl:"templates/list.html"}).fallback({name:"/404",templateUrl:"templates/404.html"});var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),_get=function(e,t,n){for(var r=!0;r;){var a=e,i=t,o=n;r=!1,null===a&&(a=Function.prototype);var s=Object.getOwnPropertyDescriptor(a,i);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(o)}var u=Object.getPrototypeOf(a);if(null===u)return;e=u,t=i,n=o,r=!0,s=u=void 0}},UserModel=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,"user",{id:{value:789787,type:"number"},name:{value:"name",type:"string"},address:{value:"221b bake",type:"string"},age:{value:null,type:"number"}})}return _inherits(t,e),_createClass(t,[{key:"upCase",value:function(e){return e.toUpperCase()}}]),t}(BaseModel),_get=function(e,t,n){for(var r=!0;r;){var a=e,i=t,o=n;r=!1,null===a&&(a=Function.prototype);var s=Object.getOwnPropertyDescriptor(a,i);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(o)}var u=Object.getPrototypeOf(a);if(null===u)return;e=u,t=i,n=o,r=!0,s=u=void 0}},ViewModel=function(e){function t(){_classCallCheck(this,t),_get(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,"view",{single:{type:"string",value:"from schema"},user:{type:"object",value:{id:{type:"number",value:88888},name:{type:"string",value:"Sherlock Holmes"},address:{type:"string",value:"221b Baker Street"}}},programmingLanguages:{type:"array",value:["javascript","ruby"]}})}return _inherits(t,e),t}(BaseModel);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5taW4uanMiLCJMaWFpc29uLmpzIiwiQmFzZU1vZGVsLmpzIiwiQmluZGluZy5qcyIsIlJvdXRlci5qcyIsIlV0aWxzLmpzIiwic2NyaXB0cy9FeGFtcGxlLmpzIiwic2NyaXB0cy9FeGFtcGxlMi5qcyIsInNjcmlwdHMvUm91dGVzLmpzIiwic2NyaXB0cy9Vc2VyTW9kZWwuanMiLCJzY3JpcHRzL1ZpZXdNb2RlbC5qcyJdLCJuYW1lcyI6WyJfY2xhc3NDYWxsQ2hlY2siLCJpbnN0YW5jZSIsIkNvbnN0cnVjdG9yIiwiVHlwZUVycm9yIiwibG9hZENvbXBvbmVudCIsIm1vZHVsZSIsImRhdGEiLCJ3aW5kb3ciLCJfaW5oZXJpdHMiLCJzdWJDbGFzcyIsInN1cGVyQ2xhc3MiLCJwcm90b3R5cGUiLCJPYmplY3QiLCJjcmVhdGUiLCJjb25zdHJ1Y3RvciIsInZhbHVlIiwiZW51bWVyYWJsZSIsIndyaXRhYmxlIiwiY29uZmlndXJhYmxlIiwic2V0UHJvdG90eXBlT2YiLCJfX3Byb3RvX18iLCJfY3JlYXRlQ2xhc3MiLCJkZWZpbmVQcm9wZXJ0aWVzIiwidGFyZ2V0IiwicHJvcHMiLCJpIiwibGVuZ3RoIiwiZGVzY3JpcHRvciIsImRlZmluZVByb3BlcnR5Iiwia2V5IiwicHJvdG9Qcm9wcyIsInN0YXRpY1Byb3BzIiwiQmFzZU1vZGVsIiwibW9kZWxOYW1lIiwic2NoZW1hIiwidGhpcyIsImV4aXN0c0luU2NoZW1hIiwiX2V4aXN0c0luU2NoZW1hIiwiY29uc29sZSIsIndhcm4iLCJ0eXBlTWF0Y2hlcyIsIl9jaGVja1R5cGUiLCJfc2V0VmFsdWUiLCJhY2Nlc3MiLCJyZXR1cm5WYWx1ZSIsInVuZGVmaW5lZCIsIl9nZXRWYWx1ZSIsIl9nZXREYXRhIiwib2JqIiwiX2FjY2VzcyIsInNwbGl0Iiwic2hpZnQiLCJ0eXBlIiwibmV3T2JqIiwiYXJndW1lbnRzIiwiZWxlbWVudCIsInJlc3BvbnNlIiwic3RhdHVzIiwiZXJyb3IiLCJFcnJvciIsInN0YXR1c1RleHQiLCJqc29uIiwiaWQiLCJnZXQiLCJ1cmwiLCJlbmRwb2ludFByZWZpeCIsInNlbmRPYmoiLCJ4aHJQcm9wZXJ0aWVzIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJsb2ciLCJmZXRjaCIsInRoZW4iLCJfY2hlY2tTdGF0dXMiLCJfcGFyc2VKU09OIiwiX2ZldGNoIiwiYXBwbHkiLCJ0b1N0cmluZyIsInNldCIsInByZWZpeCIsIl9lbmRwb2ludFByZWZpeCIsIk5vZGVMaXN0IiwiU3ltYm9sIiwiaXRlcmF0b3IiLCJBcnJheSIsIkJpbmRpbmciLCJfdGhpcyIsIl9maW5kQmluZGFibGUiLCJ1dGlscyIsIlV0aWxzIiwiY3VycmVudERhdGEiLCJzZXRJbnRlcnZhbCIsImNvbXBhcmUiLCJwYXJzZSIsIl9wb3B1bGF0ZUJpbmRpbmdzIiwiX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiIsIl9kaWRJdGVyYXRvckVycm9yIiwiX2l0ZXJhdG9yRXJyb3IiLCJfc3RlcCIsIl9pdGVyYXRvciIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvckFsbCIsIm5leHQiLCJkb25lIiwiZWxtIiwiYmluZE5hbWUiLCJhY3RpdmVFbGVtZW50IiwiZ2V0QXR0cmlidXRlIiwiX3NldEVsZW1lbnRDb250ZW50IiwiZXJyIiwiX3RoaXMyIiwiX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjIiLCJfZGlkSXRlcmF0b3JFcnJvcjIiLCJfaXRlcmF0b3JFcnJvcjIiLCJfc3RlcDIiLCJfbG9vcCIsImFkZEV2ZW50TGlzdGVuZXIiLCJldmVudCIsInNldFRpbWVvdXQiLCJzcmNFbGVtZW50IiwiX2l0ZXJhdG9yMiIsImlubmVySFRNTCIsIkxpYWlzb24iLCJkYXR1bSIsIlJvdXRlciIsInZpZXciLCJxdWVyeVNlbGVjdG9yIiwicGF0aHMiLCJ3aWxkY2FyZHMiLCJnbyIsImxvY2F0aW9uIiwiaGFzaCIsInN1YnN0cmluZyIsInN0YXRlIiwibmFtZSIsImluZGV4T2YiLCJwdXNoIiwiX2ZhbGxiYWNrIiwicm91dGUiLCJfZmluZFJvdXRlSW5QYXRocyIsInRlbXBsYXRlVXJsIiwidGV4dCIsInRlbXBsYXRlIiwiX3RoaXMzIiwicGF0aCIsInJ0biIsIl9yb3V0ZSIsIl9wYXJzZVJvdXRlIiwiZmlsdGVyIiwid2lsZGNhcmQiLCJmb3JFYWNoIiwiX3dpbGRjYXJkIiwiaW5kZXgiLCJ0ZW1wIiwidmFsIiwibGVuIiwic3RyaW5nIiwiY2hhckNvZGVBdCIsInNlbGYiLCJyZXN1bHQiLCJfcmVzdWx0IiwicHJvcGVydHkiLCJfb2JqZWN0IiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiX2hhc2hlciIsImlucHV0IiwidHlwZXMiLCJudW1iZXIiLCJib29sZWFuIiwib2JqZWN0IiwiaXRlbUEiLCJpdGVtQiIsIkV4YW1wbGUiLCJiaW5kIiwiYmluZGluZyIsImV4YW1wbGVCaW5kaW5nIiwiZXhhbXBsZVJvdXRlciIsInVzZXIiLCJVc2VyTW9kZWwiLCJhZ2UiLCJ1cENhc2UiLCJzYXZlIiwidXBkYXRlIiwiZGVzdHJveSIsInZpZXdtb2RlbCIsIlZpZXdNb2RlbCIsInJlZnJlc2giLCJFeGFtcGxlMiIsInJvdXRlciIsImZhbGxiYWNrIiwiX2dldCIsIl94IiwiX3gyIiwiX3gzIiwiX2FnYWluIiwicmVjZWl2ZXIiLCJGdW5jdGlvbiIsImRlc2MiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCJnZXR0ZXIiLCJwYXJlbnQiLCJnZXRQcm90b3R5cGVPZiIsIl9CYXNlTW9kZWwiLCJhZGRyZXNzIiwic3RyIiwidG9VcHBlckNhc2UiLCJzaW5nbGUiLCJwcm9ncmFtbWluZ0xhbmd1YWdlcyJdLCJtYXBwaW5ncyI6IkFBQ0EsWUFJQSxTQUFTQSxpQkFBZ0JDLEVBQVVDLEdBQWUsS0FBTUQsWUFBb0JDLElBQWdCLEtBQU0sSUFBSUMsV0FBVSxxQ0ErTWhILFFBQVNILGlCQUFnQkMsRUFBVUMsR0FBZSxLQUFNRCxZQUFvQkMsSUFBZ0IsS0FBTSxJQUFJQyxXQUFVLHFDQWtKaEgsUUFBU0gsaUJBQWdCQyxFQUFVQyxH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cC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUT0RPOiBhbGxvdyBhIHNoYXJlZCBmcm9udGVuZC9iYWNrZW5kIHNjaGVtYSBmaWxlXG4ndXNlIHN0cmljdCc7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSAoZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCd2YWx1ZScgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0pKCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uJyk7IH0gfVxuXG52YXIgQmFzZU1vZGVsID0gKGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gQmFzZU1vZGVsKG1vZGVsTmFtZSwgc2NoZW1hKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEJhc2VNb2RlbCk7XG5cbiAgICB0aGlzLm1vZGVsTmFtZSA9IG1vZGVsTmFtZTtcbiAgICB0aGlzLmRhdGEgPSBzY2hlbWE7XG4gIH1cblxuICBfY3JlYXRlQ2xhc3MoQmFzZU1vZGVsLCBbe1xuICAgIGtleTogJ3NldCcsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHNldChrZXksIHZhbHVlKSB7XG4gICAgICB2YXIgZXhpc3RzSW5TY2hlbWEgPSB0aGlzLl9leGlzdHNJblNjaGVtYSh0aGlzLmRhdGEsIGtleSwgdmFsdWUpO1xuICAgICAgaWYgKCFleGlzdHNJblNjaGVtYSkge1xuICAgICAgICBjb25zb2xlLndhcm4oJ05vdCBzZXR0aW5nIFwiJyArIGtleSArICdcIiBpbiAnICsgdGhpcy5tb2RlbE5hbWUgKyAnIG1vZGVsIHRvIFwiJyArIHZhbHVlICsgJ1wiLiBEb2VzbnQgZXhpc3QgaW4gdGhlIHNjaGVtYScpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB2YXIgdHlwZU1hdGNoZXMgPSB0aGlzLl9jaGVja1R5cGUodGhpcy5kYXRhLCBrZXksIHZhbHVlKTtcbiAgICAgIGlmICghdHlwZU1hdGNoZXMpIHtcbiAgICAgICAgY29uc29sZS53YXJuKCdOb3Qgc2V0dGluZyBcIicgKyBrZXkgKyAnXCIgaW4gJyArIHRoaXMubW9kZWxOYW1lICsgJyBtb2RlbCB0byBcIicgKyB2YWx1ZSArICdcIi4gSXQgaXNudCB0aGUgcmlnaHQgdHlwZScpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICB0aGlzLl9zZXRWYWx1ZSh0aGlzLmRhdGEsIGtleSwgdmFsdWUpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ2dldCcsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGdldChhY2Nlc3MpIHtcbiAgICAgIHZhciByZXR1cm5WYWx1ZSA9IHVuZGVmaW5lZDtcbiAgICAgIGlmIChhY2Nlc3MpIHtcbiAgICAgICAgcmV0dXJuVmFsdWUgPSB0aGlzLl9nZXRWYWx1ZSh0aGlzLmRhdGEsIGFjY2Vzcyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm5WYWx1ZSA9IHRoaXMuX2dldERhdGEodGhpcy5kYXRhKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXR1cm5WYWx1ZTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICdfZXhpc3RzSW5TY2hlbWEnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBfZXhpc3RzSW5TY2hlbWEob2JqLCBhY2Nlc3MsIHZhbHVlKSB7XG4gICAgICB2YXIgcmV0dXJuVmFsdWUgPSB1bmRlZmluZWQ7XG4gICAgICB2YXIgX2FjY2VzcyA9IHR5cGVvZiBhY2Nlc3MgPT09ICdzdHJpbmcnID8gYWNjZXNzLnNwbGl0KCcuJykgOiBhY2Nlc3M7XG4gICAgICBpZiAoX2FjY2Vzcy5sZW5ndGggPiAxICYmIG9ialtfYWNjZXNzWzBdXSkge1xuICAgICAgICByZXR1cm5WYWx1ZSA9IHRoaXMuX2V4aXN0c0luU2NoZW1hKG9ialtfYWNjZXNzLnNoaWZ0KCldLnZhbHVlLCBfYWNjZXNzLCB2YWx1ZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm5WYWx1ZSA9IG9ialtfYWNjZXNzWzBdXSA/IHRydWUgOiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXR1cm5WYWx1ZTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICdfY2hlY2tUeXBlJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gX2NoZWNrVHlwZShvYmosIGFjY2VzcywgdmFsdWUpIHtcbiAgICAgIHZhciByZXR1cm5WYWx1ZSA9IHVuZGVmaW5lZDtcbiAgICAgIHZhciBfYWNjZXNzID0gdHlwZW9mIGFjY2VzcyA9PT0gJ3N0cmluZycgPyBhY2Nlc3Muc3BsaXQoJy4nKSA6IGFjY2VzcztcbiAgICAgIGlmIChfYWNjZXNzLmxlbmd0aCA+IDEgJiYgb2JqW19hY2Nlc3NbMF1dKSB7XG4gICAgICAgIHJldHVyblZhbHVlID0gdGhpcy5fY2hlY2tUeXBlKG9ialtfYWNjZXNzLnNoaWZ0KCldLnZhbHVlLCBfYWNjZXNzLCB2YWx1ZSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm5WYWx1ZSA9IG9ialtfYWNjZXNzWzBdXS50eXBlID09PSB0eXBlb2YgdmFsdWU7XG4gICAgICB9XG4gICAgICByZXR1cm4gcmV0dXJuVmFsdWU7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiAnX2dldERhdGEnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBfZ2V0RGF0YShvYmopIHtcbiAgICAgIHZhciBuZXdPYmogPSBhcmd1bWVudHMubGVuZ3RoIDw9IDEgfHwgYXJndW1lbnRzWzFdID09PSB1bmRlZmluZWQgPyB7fSA6IGFyZ3VtZW50c1sxXTtcblxuICAgICAgZm9yICh2YXIgZWxlbWVudCBpbiBvYmopIHtcbiAgICAgICAgaWYgKG9ialtlbGVtZW50XS50eXBlID09PSAnb2JqZWN0Jykge1xuICAgICAgICAgIG5ld09ialtlbGVtZW50XSA9IHt9O1xuICAgICAgICAgIHRoaXMuX2dldERhdGEob2JqW2VsZW1lbnRdLnZhbHVlLCBuZXdPYmpbZWxlbWVudF0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIG5ld09ialtlbGVtZW50XSA9IG9ialtlbGVtZW50XS52YWx1ZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIG5ld09iajtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICdfc2V0VmFsdWUnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBfc2V0VmFsdWUob2JqLCBhY2Nlc3MsIHZhbHVlKSB7XG4gICAgICB2YXIgX2FjY2VzcyA9IHR5cGVvZiBhY2Nlc3MgPT09ICdzdHJpbmcnID8gYWNjZXNzLnNwbGl0KCcuJykgOiBhY2Nlc3M7XG4gICAgICBpZiAoX2FjY2Vzcy5sZW5ndGggPiAxICYmIG9ialtfYWNjZXNzWzBdXS52YWx1ZSkge1xuICAgICAgICB0aGlzLl9zZXRWYWx1ZShvYmpbX2FjY2Vzcy5zaGlmdCgpXS52YWx1ZSwgX2FjY2VzcywgdmFsdWUpO1xuICAgICAgfSBlbHNlIGlmIChvYmpbX2FjY2Vzc1swXV0udmFsdWUpIHtcbiAgICAgICAgb2JqW19hY2Nlc3NbMF1dLnZhbHVlID0gdmFsdWU7XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiAnX2dldFZhbHVlJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gX2dldFZhbHVlKG9iaiwgYWNjZXNzKSB7XG4gICAgICB2YXIgcmV0dXJuVmFsdWUgPSB1bmRlZmluZWQ7XG4gICAgICB2YXIgX2FjY2VzcyA9IGFjY2VzcztcbiAgICAgIF9hY2Nlc3MgPSB0eXBlb2YgYWNjZXNzID09PSAnc3RyaW5nJyA/IF9hY2Nlc3Muc3BsaXQoJy4nKSA6IF9hY2Nlc3M7XG4gICAgICBpZiAoX2FjY2Vzcy5sZW5ndGggPiAxICYmIG9ialtfYWNjZXNzWzBdXSkge1xuICAgICAgICByZXR1cm5WYWx1ZSA9IHRoaXMuX2dldFZhbHVlKG9ialtfYWNjZXNzLnNoaWZ0KCldLnZhbHVlLCBfYWNjZXNzKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVyblZhbHVlID0gb2JqW19hY2Nlc3NbMF1dLnZhbHVlIHx8ICcnO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHJldHVyblZhbHVlO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ19jaGVja1N0YXR1cycsXG5cbiAgICAvLyBUT0RPOiByZWZhY3RvciB0aGlzIHRvIGhlbHBlclxuICAgIHZhbHVlOiBmdW5jdGlvbiBfY2hlY2tTdGF0dXMocmVzcG9uc2UpIHtcbiAgICAgIHZhciByZXR1cm5WYWx1ZSA9IHVuZGVmaW5lZDtcbiAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPj0gMjAwICYmIHJlc3BvbnNlLnN0YXR1cyA8IDMwMCkge1xuICAgICAgICByZXR1cm5WYWx1ZSA9IHJlc3BvbnNlO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFyIGVycm9yID0gbmV3IEVycm9yKHJlc3BvbnNlLnN0YXR1c1RleHQpO1xuICAgICAgICBlcnJvci5yZXNwb25zZSA9IHJlc3BvbnNlO1xuICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXR1cm5WYWx1ZTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICdfcGFyc2VKU09OJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gX3BhcnNlSlNPTihyZXNwb25zZSkge1xuICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcbiAgICB9XG5cbiAgICAvLyBUT0RPOiBDUlVEIG9wZXJhdGlvbnMgeGhyIGNhbGxzLiByZXR1cm4gcHJvbWlzZXNcbiAgfSwge1xuICAgIGtleTogJ3NhdmUnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBzYXZlKCkge1xuICAgICAgdmFyIGlkID0gYXJndW1lbnRzLmxlbmd0aCA8PSAwIHx8IGFyZ3VtZW50c1swXSA9PT0gdW5kZWZpbmVkID8gdGhpcy5nZXQoJ2lkJykgOiBhcmd1bWVudHNbMF07XG5cbiAgICAgIHZhciB1cmwgPSB0aGlzLmVuZHBvaW50UHJlZml4ICsgJy8nICsgdGhpcy5tb2RlbE5hbWUgKyAnLycgKyBpZDtcbiAgICAgIHZhciBzZW5kT2JqID0ge307XG4gICAgICB2YXIgeGhyUHJvcGVydGllcyA9IHtcbiAgICAgICAgbWV0aG9kOiAncG9zdCcsXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHNlbmRPYmopXG4gICAgICB9O1xuXG4gICAgICBzZW5kT2JqW3RoaXMubW9kZWxOYW1lXSA9IHRoaXMuZ2V0KCk7XG4gICAgICBjb25zb2xlLmxvZygnbWFrZSBwb3N0IHhociBjYWxsIHRvICcgKyB1cmwsIHNlbmRPYmopO1xuXG4gICAgICByZXR1cm4gZmV0Y2godXJsLCB4aHJQcm9wZXJ0aWVzKS50aGVuKHRoaXMuX2NoZWNrU3RhdHVzKS50aGVuKHRoaXMuX3BhcnNlSlNPTik7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiAnZmV0Y2gnLFxuICAgIHZhbHVlOiAoZnVuY3Rpb24gKF9mZXRjaCkge1xuICAgICAgZnVuY3Rpb24gZmV0Y2goKSB7XG4gICAgICAgIHJldHVybiBfZmV0Y2guYXBwbHkodGhpcywgYXJndW1lbnRzKTtcbiAgICAgIH1cblxuICAgICAgZmV0Y2gudG9TdHJpbmcgPSBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiBfZmV0Y2gudG9TdHJpbmcoKTtcbiAgICAgIH07XG5cbiAgICAgIHJldHVybiBmZXRjaDtcbiAgICB9KShmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgaWQgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDAgfHwgYXJndW1lbnRzWzBdID09PSB1bmRlZmluZWQgPyB0aGlzLmdldCgnaWQnKSA6IGFyZ3VtZW50c1swXTtcblxuICAgICAgdmFyIHVybCA9IHRoaXMuZW5kcG9pbnRQcmVmaXggKyAnLycgKyB0aGlzLm1vZGVsTmFtZSArICcvJyArIGlkO1xuICAgICAgdmFyIHhoclByb3BlcnRpZXMgPSB7XG4gICAgICAgIG1ldGhvZDogJ2dldCdcbiAgICAgIH07XG4gICAgICBjb25zb2xlLmxvZygnbWFrZSBnZXQgeGhyIGNhbGwgdG8gJyArIHVybCk7XG5cbiAgICAgIHJldHVybiBmZXRjaCh1cmwsIHhoclByb3BlcnRpZXMpLnRoZW4odGhpcy5fY2hlY2tTdGF0dXMpLnRoZW4odGhpcy5fcGFyc2VKU09OKTtcbiAgICB9KVxuICB9LCB7XG4gICAga2V5OiAndXBkYXRlJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gdXBkYXRlKCkge1xuICAgICAgdmFyIGlkID0gYXJndW1lbnRzLmxlbmd0aCA8PSAwIHx8IGFyZ3VtZW50c1swXSA9PT0gdW5kZWZpbmVkID8gdGhpcy5nZXQoJ2lkJykgOiBhcmd1bWVudHNbMF07XG5cbiAgICAgIHZhciB1cmwgPSB0aGlzLmVuZHBvaW50UHJlZml4ICsgJy8nICsgdGhpcy5tb2RlbE5hbWUgKyAnLycgKyBpZDtcbiAgICAgIHZhciBzZW5kT2JqID0ge307XG4gICAgICBzZW5kT2JqW3RoaXMubW9kZWxOYW1lXSA9IHRoaXMuZ2V0KCk7XG4gICAgICBjb25zb2xlLmxvZygnbWFrZSB1cGRhdGUgeGhyIGNhbGwgdG8gJyArIHVybCwgc2VuZE9iaik7XG5cbiAgICAgIC8vIEdpdGh1YidzIGZldGNoIHByb2plY3QgZG9lc250IGFwcGVhciB0byBzdXBwb3J0IFVQREFURVxuICAgICAgLy8gVE9ETzogaW52ZXN0aWdhdGUgdGhlIGFib3ZlIHN0YXRlbWVudFxuICAgICAgLy8gZmV0Y2godXJsLCB7XG4gICAgICAvLyAgIG1ldGhvZDogJ1VQREFURScsXG4gICAgICAvLyAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHNlbmRPYmopXG4gICAgICAvLyB9KTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICdkZXN0cm95JyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gZGVzdHJveSgpIHtcbiAgICAgIHZhciBpZCA9IGFyZ3VtZW50cy5sZW5ndGggPD0gMCB8fCBhcmd1bWVudHNbMF0gPT09IHVuZGVmaW5lZCA/IHRoaXMuZ2V0KCdpZCcpIDogYXJndW1lbnRzWzBdO1xuXG4gICAgICB2YXIgdXJsID0gdGhpcy5lbmRwb2ludFByZWZpeCArICcvJyArIHRoaXMubW9kZWxOYW1lICsgJy8nICsgaWQ7XG4gICAgICB2YXIgeGhyUHJvcGVydGllcyA9IHtcbiAgICAgICAgbWV0aG9kOiAnZGVsZXRlJ1xuICAgICAgfTtcbiAgICAgIGNvbnNvbGUubG9nKCdtYWtlIGRlbGV0ZSB4aHIgY2FsbCB0byAnICsgdXJsKTtcblxuICAgICAgcmV0dXJuIGZldGNoKHVybCwgeGhyUHJvcGVydGllcykudGhlbih0aGlzLl9jaGVja1N0YXR1cykudGhlbih0aGlzLl9wYXJzZUpTT04pO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ2VuZHBvaW50UHJlZml4JyxcbiAgICBzZXQ6IGZ1bmN0aW9uIHNldChwcmVmaXgpIHtcbiAgICAgIHRoaXMuX2VuZHBvaW50UHJlZml4ID0gcHJlZml4O1xuICAgIH0sXG4gICAgZ2V0OiBmdW5jdGlvbiBnZXQoKSB7XG4gICAgICByZXR1cm4gdGhpcy5fZW5kcG9pbnRQcmVmaXggfHwgJ2FwaS92aSc7XG4gICAgfVxuICB9XSk7XG5cbiAgcmV0dXJuIEJhc2VNb2RlbDtcbn0pKCk7XG4vLyBhbGxvd2luZyBmb3IuLm9mIG9mIG5vZGVsaXN0cyBmb3IgQ2hyb21lIHN1cHBvcnRcbid1c2Ugc3RyaWN0JztcblxudmFyIF9jcmVhdGVDbGFzcyA9IChmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoJ3ZhbHVlJyBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSkoKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24nKTsgfSB9XG5cbk5vZGVMaXN0LnByb3RvdHlwZVtTeW1ib2wuaXRlcmF0b3JdID0gQXJyYXkucHJvdG90eXBlW1N5bWJvbC5pdGVyYXRvcl07XG5cbnZhciBCaW5kaW5nID0gKGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gQmluZGluZyhkYXRhKSB7XG4gICAgdmFyIF90aGlzID0gdGhpcztcblxuICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBCaW5kaW5nKTtcblxuICAgIHRoaXMuZGF0YSA9IGRhdGE7XG4gICAgdGhpcy5fZmluZEJpbmRhYmxlKCk7XG4gICAgdGhpcy51dGlscyA9IG5ldyBVdGlscygpO1xuXG4gICAgdmFyIGN1cnJlbnREYXRhID0gY3VycmVudERhdGEgfHwge307XG5cbiAgICAvLyB3YXRjaGluZyB0aGlzLmRhdGEgZm9yIHByb2dyYW1tYXRpY2FsIHVwZGF0ZXNcbiAgICBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAoX3RoaXMudXRpbHMuY29tcGFyZShjdXJyZW50RGF0YSwgX3RoaXMuZGF0YSkgPT09IGZhbHNlKSB7XG4gICAgICAgIGN1cnJlbnREYXRhID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShfdGhpcy5kYXRhKSk7XG4gICAgICAgIF90aGlzLl9wb3B1bGF0ZUJpbmRpbmdzKCk7XG4gICAgICB9XG4gICAgfSwgMTApO1xuICB9XG5cbiAgX2NyZWF0ZUNsYXNzKEJpbmRpbmcsIFt7XG4gICAga2V5OiAnX3BvcHVsYXRlQmluZGluZ3MnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBfcG9wdWxhdGVCaW5kaW5ncygpIHtcbiAgICAgIHZhciBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uID0gdHJ1ZTtcbiAgICAgIHZhciBfZGlkSXRlcmF0b3JFcnJvciA9IGZhbHNlO1xuICAgICAgdmFyIF9pdGVyYXRvckVycm9yID0gdW5kZWZpbmVkO1xuXG4gICAgICB0cnkge1xuICAgICAgICBmb3IgKHZhciBfaXRlcmF0b3IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbbGlhaXNvbi1iaW5kXScpW1N5bWJvbC5pdGVyYXRvcl0oKSwgX3N0ZXA7ICEoX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiA9IChfc3RlcCA9IF9pdGVyYXRvci5uZXh0KCkpLmRvbmUpOyBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uID0gdHJ1ZSkge1xuICAgICAgICAgIHZhciBlbG0gPSBfc3RlcC52YWx1ZTtcblxuICAgICAgICAgIHZhciBiaW5kTmFtZSA9IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQuZ2V0QXR0cmlidXRlKCdsaWFpc29uLWJpbmQnKTtcblxuICAgICAgICAgIC8vIHByZXZlbnQgdGhlIGlucHV0IHlvdXJlIHR5cGluZyBpbiBmcm9tIHVwZGF0aW5nLiBwcmV2ZW50cyB0aGUgY3Vyc29yIGZyb20ganVtcGluZyB0byB0aGUgZW5kXG4gICAgICAgICAgLy8gb25seSB1cGRhdGVzIGJpbmRpbmdzIHRoYXQgbmVlZCB0byBiZSB1cGRhdGVkXG4gICAgICAgICAgaWYgKGVsbSAhPT0gZG9jdW1lbnQuYWN0aXZlRWxlbWVudCAmJiAoZWxtLmdldEF0dHJpYnV0ZSgnbGlhaXNvbi1iaW5kJykgPT09IGJpbmROYW1lIHx8IGJpbmROYW1lID09PSBudWxsKSkge1xuICAgICAgICAgICAgdGhpcy5fc2V0RWxlbWVudENvbnRlbnQoZWxtLCB0aGlzLl9nZXRWYWx1ZSh0aGlzLmRhdGEsIGVsbS5nZXRBdHRyaWJ1dGUoJ2xpYWlzb24tYmluZCcpKSk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgX2RpZEl0ZXJhdG9yRXJyb3IgPSB0cnVlO1xuICAgICAgICBfaXRlcmF0b3JFcnJvciA9IGVycjtcbiAgICAgIH0gZmluYWxseSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgaWYgKCFfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uICYmIF9pdGVyYXRvclsncmV0dXJuJ10pIHtcbiAgICAgICAgICAgIF9pdGVyYXRvclsncmV0dXJuJ10oKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZmluYWxseSB7XG4gICAgICAgICAgaWYgKF9kaWRJdGVyYXRvckVycm9yKSB7XG4gICAgICAgICAgICB0aHJvdyBfaXRlcmF0b3JFcnJvcjtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICdfZmluZEJpbmRhYmxlJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gX2ZpbmRCaW5kYWJsZSgpIHtcbiAgICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG4gICAgICB2YXIgX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjIgPSB0cnVlO1xuICAgICAgdmFyIF9kaWRJdGVyYXRvckVycm9yMiA9IGZhbHNlO1xuICAgICAgdmFyIF9pdGVyYXRvckVycm9yMiA9IHVuZGVmaW5lZDtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgdmFyIF9sb29wID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHZhciBlbG0gPSBfc3RlcDIudmFsdWU7XG5cbiAgICAgICAgICBlbG0uYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgLy8gc2V0dGltZW91dCBhbGxvd3MgdGhlIGtleWRvd24gZXZlbnQgZ28gZ2V0IHRoZSBuZXcgdmFsdWVcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICByZXR1cm4gX3RoaXMyLl9zZXRWYWx1ZShfdGhpczIuZGF0YSwgZWxtLmdldEF0dHJpYnV0ZSgnbGlhaXNvbi1iaW5kJyksIGV2ZW50LnNyY0VsZW1lbnQudmFsdWUpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgZm9yICh2YXIgX2l0ZXJhdG9yMiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tsaWFpc29uLWJpbmRdJylbU3ltYm9sLml0ZXJhdG9yXSgpLCBfc3RlcDI7ICEoX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbjIgPSAoX3N0ZXAyID0gX2l0ZXJhdG9yMi5uZXh0KCkpLmRvbmUpOyBfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uMiA9IHRydWUpIHtcbiAgICAgICAgICBfbG9vcCgpO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgX2RpZEl0ZXJhdG9yRXJyb3IyID0gdHJ1ZTtcbiAgICAgICAgX2l0ZXJhdG9yRXJyb3IyID0gZXJyO1xuICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBpZiAoIV9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24yICYmIF9pdGVyYXRvcjJbJ3JldHVybiddKSB7XG4gICAgICAgICAgICBfaXRlcmF0b3IyWydyZXR1cm4nXSgpO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBmaW5hbGx5IHtcbiAgICAgICAgICBpZiAoX2RpZEl0ZXJhdG9yRXJyb3IyKSB7XG4gICAgICAgICAgICB0aHJvdyBfaXRlcmF0b3JFcnJvcjI7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiAnX3NldEVsZW1lbnRDb250ZW50JyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gX3NldEVsZW1lbnRDb250ZW50KGVsZW1lbnQsIHZhbHVlKSB7XG4gICAgICAvLyBhbGxvd3MgbXVsdGlwbGUgY29tcG9uZW50c1xuICAgICAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHJldHVybjtcbiAgICAgIGVsZW1lbnQuaW5uZXJIVE1MID0gdmFsdWU7XG4gICAgICBlbGVtZW50LnZhbHVlID0gdmFsdWU7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiAnX3NldFZhbHVlJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gX3NldFZhbHVlKG9iaiwgYWNjZXNzLCB2YWx1ZSkge1xuICAgICAgdmFyIF9hY2Nlc3MgPSBhY2Nlc3M7XG4gICAgICBpZiAodHlwZW9mIF9hY2Nlc3MgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIF9hY2Nlc3MgPSBfYWNjZXNzLnNwbGl0KCcuJyk7XG4gICAgICB9XG4gICAgICBpZiAoX2FjY2Vzcy5sZW5ndGggPiAxICYmIG9ialtfYWNjZXNzWzBdXSkge1xuICAgICAgICB0aGlzLl9zZXRWYWx1ZShvYmpbX2FjY2Vzcy5zaGlmdCgpXSwgX2FjY2VzcywgdmFsdWUpO1xuICAgICAgfSBlbHNlIGlmICh0eXBlb2Ygb2JqW19hY2Nlc3NbMF1dID09PSAnc3RyaW5nJykge1xuICAgICAgICBvYmpbX2FjY2Vzc1swXV0gPSB2YWx1ZTtcbiAgICAgIH1cbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICdfZ2V0VmFsdWUnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBfZ2V0VmFsdWUob2JqLCBhY2Nlc3MpIHtcbiAgICAgIHZhciBfYWNjZXNzID0gYWNjZXNzO1xuICAgICAgdmFyIHJldHVyblZhbHVlID0gdW5kZWZpbmVkO1xuICAgICAgaWYgKHR5cGVvZiBfYWNjZXNzID09PSAnc3RyaW5nJykge1xuICAgICAgICBfYWNjZXNzID0gX2FjY2Vzcy5zcGxpdCgnLicpO1xuICAgICAgfVxuICAgICAgaWYgKF9hY2Nlc3MubGVuZ3RoID4gMSAmJiBvYmpbX2FjY2Vzc1swXV0pIHtcbiAgICAgICAgcmV0dXJuVmFsdWUgPSB0aGlzLl9nZXRWYWx1ZShvYmpbX2FjY2Vzcy5zaGlmdCgpXSwgX2FjY2Vzcyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm5WYWx1ZSA9IG9ialtfYWNjZXNzWzBdXTtcbiAgICAgIH1cbiAgICAgIHJldHVybiByZXR1cm5WYWx1ZTtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICdyZWZyZXNoJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gcmVmcmVzaChkYXRhKSB7XG4gICAgICB0aGlzLmRhdGEgPSBkYXRhO1xuICAgICAgdGhpcy5fcG9wdWxhdGVCaW5kaW5ncygpO1xuICAgIH1cbiAgfV0pO1xuXG4gIHJldHVybiBCaW5kaW5nO1xufSkoKTtcblwidXNlIHN0cmljdFwiO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7IH0gfVxuXG52YXIgTGlhaXNvbiA9IGZ1bmN0aW9uIExpYWlzb24oZGF0YSkge1xuICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgTGlhaXNvbik7XG5cbiAgZm9yICh2YXIgZGF0dW0gaW4gZGF0YSkge1xuICAgIGlmIChkYXR1bSkge1xuICAgICAgdGhpc1tkYXR1bV0gPSBkYXRhW2RhdHVtXTtcbiAgICB9XG4gIH1cbn07XG5cbmZ1bmN0aW9uIGxvYWRDb21wb25lbnQobW9kdWxlLCBkYXRhKSB7XG4gIHJldHVybiBuZXcgd2luZG93W21vZHVsZV0oZGF0YSk7XG59XG4ndXNlIHN0cmljdCc7XG5cbnZhciBfY3JlYXRlQ2xhc3MgPSAoZnVuY3Rpb24gKCkgeyBmdW5jdGlvbiBkZWZpbmVQcm9wZXJ0aWVzKHRhcmdldCwgcHJvcHMpIHsgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykgeyB2YXIgZGVzY3JpcHRvciA9IHByb3BzW2ldOyBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7IGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTsgaWYgKCd2YWx1ZScgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7IE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0YXJnZXQsIGRlc2NyaXB0b3Iua2V5LCBkZXNjcmlwdG9yKTsgfSB9IHJldHVybiBmdW5jdGlvbiAoQ29uc3RydWN0b3IsIHByb3RvUHJvcHMsIHN0YXRpY1Byb3BzKSB7IGlmIChwcm90b1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLnByb3RvdHlwZSwgcHJvdG9Qcm9wcyk7IGlmIChzdGF0aWNQcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvciwgc3RhdGljUHJvcHMpOyByZXR1cm4gQ29uc3RydWN0b3I7IH07IH0pKCk7XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uJyk7IH0gfVxuXG52YXIgUm91dGVyID0gKGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gUm91dGVyKCkge1xuICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgUm91dGVyKTtcblxuICAgIHRoaXMudXRpbHMgPSBuZXcgVXRpbHMoKTtcbiAgICB0aGlzLnZpZXcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbbGlhaXNvbi12aWV3XScpO1xuICAgIHRoaXMucGF0aHMgPSBbXTtcbiAgICB0aGlzLndpbGRjYXJkcyA9IFtdO1xuICAgIC8vIGdvZXMgdG8gaGFzaCB1cmxcbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBfdGhpcy5nbyh3aW5kb3cubG9jYXRpb24uaGFzaC5zdWJzdHJpbmcoMSkpO1xuICAgIH0sIDApO1xuICAgIC8vIGFsbG93cyBiYWNrL2ZvcndhcmQgYnV0dG9uc1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdwb3BzdGF0ZScsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgcmV0dXJuIF90aGlzLmdvKGV2ZW50LnN0YXRlIHx8IHdpbmRvdy5sb2NhdGlvbi5oYXNoLnN1YnN0cmluZygxKSwgZmFsc2UpO1xuICAgIH0pO1xuICB9XG5cbiAgLy8gKiBvbiBwYWdlIGxvYWQsIGdldCB1cmwgYW5kIGxvYWQgYXBwcm9wcmlhdGUgdGVtdHBsYXRlXG4gIC8vICogb24gdXJsIGNoYW5nZSwgdXBkYXRlIHRlbXBsYXRlXG4gIC8vICogYWxsb3cgd2lsZGNhcmRzIGluIHBhdGhzIC90ZW1wbGF0ZS91c2VyLzppZFxuICAvLyBwYXNzIHZhcmlhYmxlcyB0byB0ZW1wbGF0ZVxuICAvLyBhbGxvdyBjb21wb25lbnQgdG8gYmUgZGVjbGFyZWQgaW4gcm91dGUgb2JqZWN0XG4gIC8vICogZ2V0IHN0YXRlIChpZiBzdGF0ZSA9PSAnaHVob2hvaGFvJykuLi5cbiAgLy8gKiB1cGRhdGUgc3RhdGUgb24gZm9yd2FyZC9iYWNrXG4gIC8vICogcm91dGVzIG9uIHJlZnJlc2hcblxuICBfY3JlYXRlQ2xhc3MoUm91dGVyLCBbe1xuICAgIGtleTogJ3N0YXRlJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gc3RhdGUoZGF0YSkge1xuICAgICAgaWYgKGRhdGEubmFtZS5pbmRleE9mKCc6JykgPiAwKSB7XG4gICAgICAgIHRoaXMud2lsZGNhcmRzLnB1c2goZGF0YSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnBhdGhzLnB1c2goZGF0YSk7XG4gICAgICB9XG4gICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICdmYWxsYmFjaycsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGZhbGxiYWNrKGRhdGEpIHtcbiAgICAgIHRoaXMucGF0aHMucHVzaChkYXRhKTtcbiAgICAgIHRoaXMuX2ZhbGxiYWNrID0gZGF0YTtcbiAgICB9XG5cbiAgICAvLyBpbnRlZ3JhdGlvbiB0ZXN0cyBjb3ZlciB0aGlzXG4gIH0sIHtcbiAgICBrZXk6ICdnbycsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGdvKHJvdXRlKSB7XG4gICAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuICAgICAgY29uc29sZS5sb2coJ2dvaW5nIHRvIHN0YXRlICcgKyByb3V0ZSk7XG4gICAgICB2YXIgb2JqID0gdGhpcy5fZmluZFJvdXRlSW5QYXRocyhyb3V0ZSk7XG4gICAgICBpZiAoIW9iaikge1xuICAgICAgICB0aGlzLmdvKHRoaXMuX2ZhbGxiYWNrLm5hbWUpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICBmZXRjaChvYmoudGVtcGxhdGVVcmwpLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICAgIHJldHVybiByZXNwb25zZS50ZXh0KCk7XG4gICAgICB9KS50aGVuKGZ1bmN0aW9uICh0ZW1wbGF0ZSkge1xuICAgICAgICBfdGhpczIudmlldy5pbm5lckhUTUwgPSB0ZW1wbGF0ZTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIFRPRE86IGNsZWFuIHRoaXMgdXAuIHRoZXJlIGhhcyB0byBiZSBhIGJldHRlciB3YXlcbiAgfSwge1xuICAgIGtleTogJ19maW5kUm91dGVJblBhdGhzJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gX2ZpbmRSb3V0ZUluUGF0aHMocm91dGUpIHtcbiAgICAgIHZhciBfdGhpczMgPSB0aGlzO1xuXG4gICAgICAvLyBzZWFyY2hpbmcgZm9yIG5hdHVyYWwgcGF0aFxuICAgICAgdmFyIF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gPSB0cnVlO1xuICAgICAgdmFyIF9kaWRJdGVyYXRvckVycm9yID0gZmFsc2U7XG4gICAgICB2YXIgX2l0ZXJhdG9yRXJyb3IgPSB1bmRlZmluZWQ7XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIGZvciAodmFyIF9pdGVyYXRvciA9IHRoaXMucGF0aHNbU3ltYm9sLml0ZXJhdG9yXSgpLCBfc3RlcDsgIShfaXRlcmF0b3JOb3JtYWxDb21wbGV0aW9uID0gKF9zdGVwID0gX2l0ZXJhdG9yLm5leHQoKSkuZG9uZSk7IF9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24gPSB0cnVlKSB7XG4gICAgICAgICAgdmFyIHBhdGggPSBfc3RlcC52YWx1ZTtcblxuICAgICAgICAgIGlmIChwYXRoLm5hbWUgPT09IHJvdXRlKSByZXR1cm4gcGF0aDtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIG5vIG5hdHVyYWwgcGF0aCBmb3VuZC4gc2VhcmNoaW5nIHdpbGRjYXJkc1xuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIF9kaWRJdGVyYXRvckVycm9yID0gdHJ1ZTtcbiAgICAgICAgX2l0ZXJhdG9yRXJyb3IgPSBlcnI7XG4gICAgICB9IGZpbmFsbHkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgIGlmICghX2l0ZXJhdG9yTm9ybWFsQ29tcGxldGlvbiAmJiBfaXRlcmF0b3JbJ3JldHVybiddKSB7XG4gICAgICAgICAgICBfaXRlcmF0b3JbJ3JldHVybiddKCk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGZpbmFsbHkge1xuICAgICAgICAgIGlmIChfZGlkSXRlcmF0b3JFcnJvcikge1xuICAgICAgICAgICAgdGhyb3cgX2l0ZXJhdG9yRXJyb3I7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIHZhciBydG4gPSB1bmRlZmluZWQ7XG4gICAgICB2YXIgX3JvdXRlID0gdGhpcy5fcGFyc2VSb3V0ZShyb3V0ZSk7XG5cbiAgICAgIC8vIGZpbHRlciBieSB1cmwgc2VjdGlvbnNcbiAgICAgIHRoaXMud2lsZGNhcmRzLmZpbHRlcihmdW5jdGlvbiAod2lsZGNhcmQpIHtcbiAgICAgICAgcmV0dXJuIF90aGlzMy5fcGFyc2VSb3V0ZSh3aWxkY2FyZC5uYW1lKS5sZW5ndGggPT09IF9yb3V0ZS5sZW5ndGg7IC8vIGZpbHRlcnMgYnkgbWF0Y2hpbmcgbGVuZ3RocyBmaXJzdFxuICAgICAgfSkuZm9yRWFjaChmdW5jdGlvbiAod2lsZGNhcmQpIHtcbiAgICAgICAgdmFyIF93aWxkY2FyZCA9IF90aGlzMy5fcGFyc2VSb3V0ZSh3aWxkY2FyZC5uYW1lKTtcbiAgICAgICAgLy8gaXRlcmF0aW5nIG92ZXIgZWFjaCBlbGVtZW50IGluIHRoZSB3aWxkY2FyZC4gaWUgW3VzZXIsIDppZCwgOnN1YmlkXVxuICAgICAgICBfd2lsZGNhcmQuZm9yRWFjaChmdW5jdGlvbiAoZWxlbWVudCwgaW5kZXgpIHtcbiAgICAgICAgICBpZiAoZWxlbWVudC5pbmRleE9mKCc6JykgIT09IDApIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAvLyByZXBsYWNlcyB3aWxkY2FyZHMgd2l0aCBhY3R1YWwgdmFsdWVzIHNvIHRoZXkgY2FuIGJlIGNvbXBhcmVkXG4gICAgICAgICAgdmFyIHRlbXAgPSBfd2lsZGNhcmQ7XG4gICAgICAgICAgdGVtcFtpbmRleF0gPSBfcm91dGVbaW5kZXhdO1xuICAgICAgICAgIGlmIChfdGhpczMudXRpbHMuY29tcGFyZSh0ZW1wLCBfcm91dGUpKSBydG4gPSB3aWxkY2FyZDtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBydG47XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiAnX3BhcnNlUm91dGUnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBfcGFyc2VSb3V0ZShyb3V0ZSkge1xuICAgICAgcmV0dXJuIHJvdXRlLnN1YnN0cmluZygxKS5zcGxpdCgnLycpO1xuICAgIH1cbiAgfV0pO1xuXG4gIHJldHVybiBSb3V0ZXI7XG59KSgpO1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gKGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgndmFsdWUnIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KSgpO1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbicpOyB9IH1cblxudmFyIFV0aWxzID0gKGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gVXRpbHMoKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFV0aWxzKTtcbiAgfVxuXG4gIF9jcmVhdGVDbGFzcyhVdGlscywgW3tcbiAgICBrZXk6ICdfaGFzaGVyJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gX2hhc2hlcih2YWwpIHtcbiAgICAgIHZhciBoYXNoID0gMDtcbiAgICAgIHZhciBpbmRleCA9IHVuZGVmaW5lZDtcbiAgICAgIHZhciBsZW4gPSB1bmRlZmluZWQ7XG4gICAgICB2YXIgc3RyaW5nID0gdmFsLnRvU3RyaW5nKCk7XG4gICAgICBmb3IgKGluZGV4ID0gMCwgbGVuID0gc3RyaW5nLmxlbmd0aDsgaW5kZXggPCBsZW47IGluZGV4KyspIHtcbiAgICAgICAgaGFzaCA9IChoYXNoIDw8IDUpIC0gaGFzaCArIHN0cmluZy5jaGFyQ29kZUF0KGluZGV4KSAmIDB4RkZGRkZGRkY7XG4gICAgICB9XG4gICAgICByZXR1cm4gaGFzaDtcbiAgICB9XG4gIH0sIHtcbiAgICBrZXk6ICdfb2JqZWN0JyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gX29iamVjdChzZWxmLCBvYmopIHtcbiAgICAgIHZhciByZXN1bHQgPSBhcmd1bWVudHMubGVuZ3RoIDw9IDIgfHwgYXJndW1lbnRzWzJdID09PSB1bmRlZmluZWQgPyAwIDogYXJndW1lbnRzWzJdO1xuXG4gICAgICB2YXIgX3Jlc3VsdCA9IHJlc3VsdDtcbiAgICAgIGZvciAodmFyIHByb3BlcnR5IGluIG9iaikge1xuICAgICAgICBpZiAodHlwZW9mIG9ialtwcm9wZXJ0eV0gPT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuX29iamVjdChzZWxmLCBvYmpbcHJvcGVydHldLCBfcmVzdWx0KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3BlcnR5KSkge1xuICAgICAgICAgIF9yZXN1bHQgKz0gc2VsZi5faGFzaGVyKHByb3BlcnR5ICsgc2VsZi5faGFzaGVyKG9ialtwcm9wZXJ0eV0pKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIF9yZXN1bHQ7XG4gICAgfVxuICB9LCB7XG4gICAga2V5OiAnaGFzaCcsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGhhc2goaW5wdXQpIHtcbiAgICAgIHZhciB0eXBlcyA9IHtcbiAgICAgICAgJ3N0cmluZyc6IHRoaXMuX2hhc2hlcixcbiAgICAgICAgJ251bWJlcic6IHRoaXMuX2hhc2hlcixcbiAgICAgICAgJ2Jvb2xlYW4nOiB0aGlzLl9oYXNoZXIsXG4gICAgICAgICdvYmplY3QnOiB0aGlzLm9iamVjdFxuICAgICAgfTtcbiAgICAgIHZhciB0eXBlID0gdHlwZW9mIGlucHV0O1xuXG4gICAgICByZXR1cm4gaW5wdXQgIT09IG51bGwgJiYgdHlwZXNbdHlwZV0gPyB0eXBlc1t0eXBlXSh0aGlzLCBpbnB1dCkgKyB0aGlzLl9oYXNoZXIodHlwZSkgOiAwO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ2NvbXBhcmVIYXNoZXMnLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBjb21wYXJlSGFzaGVzKGl0ZW1BLCBpdGVtQikge1xuICAgICAgcmV0dXJuIHRoaXMuaGFzaChpdGVtQSkgPT09IHRoaXMuaGFzaChpdGVtQik7XG4gICAgfVxuXG4gICAgLy8gZmFzdGVyIHRoYW4gY29tcGFyZUhhc2hlc1xuICB9LCB7XG4gICAga2V5OiAnY29tcGFyZScsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIGNvbXBhcmUoaXRlbUEsIGl0ZW1CKSB7XG4gICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoaXRlbUEpID09PSBKU09OLnN0cmluZ2lmeShpdGVtQik7XG4gICAgfVxuICB9XSk7XG5cbiAgcmV0dXJuIFV0aWxzO1xufSkoKTtcbid1c2Ugc3RyaWN0JztcblxudmFyIF9jcmVhdGVDbGFzcyA9IChmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoJ3ZhbHVlJyBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSkoKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24nKTsgfSB9XG5cbnZhciBFeGFtcGxlID0gKGZ1bmN0aW9uICgpIHtcbiAgZnVuY3Rpb24gRXhhbXBsZShkYXRhKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEV4YW1wbGUpO1xuXG4gICAgdGhpcy5iaW5kID0gbmV3IExpYWlzb24oZGF0YSk7XG4gICAgY29uc29sZS5sb2codGhpcy5iaW5kKTtcbiAgICB0aGlzLmJpbmRpbmcgPSBuZXcgQmluZGluZyh0aGlzLmJpbmQpO1xuICAgIHRoaXMuZXhhbXBsZUJpbmRpbmcoKTtcbiAgICB0aGlzLmV4YW1wbGVSb3V0ZXIoKTtcbiAgfVxuXG4gIF9jcmVhdGVDbGFzcyhFeGFtcGxlLCBbe1xuICAgIGtleTogJ2V4YW1wbGVCaW5kaW5nJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gZXhhbXBsZUJpbmRpbmcoKSB7XG4gICAgICAvLyBoZXJlIHlvdSBoYXZlIGFjY2VzcyB0byB0aGlzLmJpbmQudXNlciBhbmQgdGhpcy5iaW5kLnByb2dyYW1taW5nX2xhbmd1YWdlc1xuICAgICAgLy8gY29uc29sZS5sb2codGhpcy5iaW5kLnVzZXIpO1xuICAgICAgLy8gY29uc29sZS5sb2codGhpcy5iaW5kLnByb2dyYW1taW5nX2xhbmd1YWdlcyk7XG5cbiAgICAgIC8vIG1vZGVsIGV4YW1wbGVzXG4gICAgICB2YXIgdXNlciA9IG5ldyBVc2VyTW9kZWwoKTtcbiAgICAgIHVzZXIuc2V0KCdhZ2UnLCAnODc3NycpOyAvLyBzaG91bGQgZmFpbFxuICAgICAgdXNlci5zZXQoJ25hbWUnLCAnbXkgZmlyc3QgbmFtZSBvbiB1c2VyIG1vZGVsJyk7IC8vIHNob3VsZCBwYXNzXG4gICAgICB1c2VyLnNldCgnYWdlJywge1xuICAgICAgICBhZ2U6IDMzXG4gICAgICB9KTsgLy8gc2hvdWxkIGZhaWxcbiAgICAgIHVzZXIuc2V0KCdhZ2UnLCA5OTkpOyAvLyBzaG91bGQgcGFzc1xuICAgICAgdXNlci5zZXQoJ2FkZHJlc3MnLCAnbXkgYWRkcmVzcycpOyAvLyBzaG91bGQgcGFzc1xuXG4gICAgICAvLyBzZXRzIGRhdGEgYmluZGluZ1xuICAgICAgLy8gdGhpcy5iaW5kLnVzZXIubmFtZSA9IHVzZXIuZ2V0KCduYW1lJylcbiAgICAgIHVzZXIuc2V0KCdhZGRyZXNzJywgdXNlci51cENhc2UoJ215IHNlY29uZCBhZGRyZXNzJykpOyAvLyBzaG91bGQgcGFzcyBhbmQgcG9zdGZpeCBcIiFcIiB0byB0aGUgYWRkcmVzc1xuXG4gICAgICB1c2VyLnNhdmUoKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ3RoZW4nKTtcbiAgICAgIH0pWydjYXRjaCddKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmxvZygncmVxdWVzdCBmYWlsZWQnLCBlcnJvcik7XG4gICAgICB9KTtcbiAgICAgIHVzZXIudXBkYXRlKCk7XG4gICAgICB1c2VyLmZldGNoKCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCd0aGVuJyk7XG4gICAgICB9KVsnY2F0Y2gnXShmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ3JlcXVlc3QgZmFpbGVkJywgZXJyb3IpO1xuICAgICAgfSk7XG4gICAgICB1c2VyLmRlc3Ryb3koKS50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ3RoZW4nKTtcbiAgICAgIH0pWydjYXRjaCddKGZ1bmN0aW9uIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmxvZygncmVxdWVzdCBmYWlsZWQnLCBlcnJvcik7XG4gICAgICB9KTtcblxuICAgICAgLy8gc2Vjb25kIG1vZGVsXG4gICAgICB2YXIgdmlld21vZGVsID0gbmV3IFZpZXdNb2RlbCgpO1xuICAgICAgLy8gc2hvdWxkIHBhc3NcbiAgICAgIHZpZXdtb2RlbC5zZXQoJ3NpbmdsZScsICd1cGRhdGVkIHZpYSB2aWV3bW9kZWwgbW9kZWwgc2V0IGZ1bmN0aW9uJyk7XG4gICAgICAvLyBzaG91bGQgcGFzc1xuICAgICAgdmlld21vZGVsLnNldCgndXNlci5uYW1lJywgJ215IHNlY29uZCBleGFtcGxlIG5hbWUnKTtcbiAgICAgIC8vIHNob3VsZCBmYWlsXG4gICAgICB2aWV3bW9kZWwuc2V0KCd1c2VyLmFnZScsIHtcbiAgICAgICAgYWdlOiAyMlxuICAgICAgfSk7XG4gICAgICAvLyBzaG91bGQgZmFpbFxuICAgICAgdmlld21vZGVsLnNldCgndXNlci5hZ2UnLCA0NDQpO1xuICAgICAgLy8gc2hvdWxkIGZhaWxcbiAgICAgIHZpZXdtb2RlbC5zZXQoJ3VzZXIuYWRkcmVzcycsIDc3ODc4KTtcbiAgICAgIC8vIHNob3VsZCBwYXNzXG4gICAgICB2aWV3bW9kZWwuc2V0KCd1c2VyLmFkZHJlc3MnLCAnbXkgc2Vjb25kIGFkZHJlc3MnKTtcblxuICAgICAgLy8gc2V0cyBkYXRhIGJpbmRpbmdcbiAgICAgIC8vIHRoaXMuYmluZCA9IHZpZXdtb2RlbC5nZXQoKVxuICAgICAgLy8gdGhpcy5iaW5kLnVzZXIgPSB1c2VyLmdldCgpXG4gICAgICB0aGlzLmJpbmRpbmcucmVmcmVzaCh0aGlzLmJpbmQpO1xuICAgIH1cbiAgfSwge1xuICAgIGtleTogJ2V4YW1wbGVSb3V0ZXInLFxuICAgIHZhbHVlOiBmdW5jdGlvbiBleGFtcGxlUm91dGVyKCkge1xuICAgICAgLy8gY2hhbmdlIHN0YXRlIHRvIC9saXN0XG4gICAgICAvLyByb3V0ZXIuZ28oJ2hvZG9yLzEyJywge215ZGF0YToxMjM0NTU2LCBteW9iajp7bmFtZTonc2hlcmxvY2snfX0pO1xuICAgICAgLy8gc2V0VGltZW91dCgoKT0+IHdpbmRvdy5yb3V0ZXIuZ28oJ2xpc3QnKSwyMDAwKVxuICAgIH1cbiAgfV0pO1xuXG4gIHJldHVybiBFeGFtcGxlO1xufSkoKTtcbid1c2Ugc3RyaWN0JztcblxudmFyIF9jcmVhdGVDbGFzcyA9IChmdW5jdGlvbiAoKSB7IGZ1bmN0aW9uIGRlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykgeyBmb3IgKHZhciBpID0gMDsgaSA8IHByb3BzLmxlbmd0aDsgaSsrKSB7IHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07IGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTsgZGVzY3JpcHRvci5jb25maWd1cmFibGUgPSB0cnVlOyBpZiAoJ3ZhbHVlJyBpbiBkZXNjcmlwdG9yKSBkZXNjcmlwdG9yLndyaXRhYmxlID0gdHJ1ZTsgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpOyB9IH0gcmV0dXJuIGZ1bmN0aW9uIChDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHsgaWYgKHByb3RvUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTsgaWYgKHN0YXRpY1Byb3BzKSBkZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7IHJldHVybiBDb25zdHJ1Y3RvcjsgfTsgfSkoKTtcblxuZnVuY3Rpb24gX2NsYXNzQ2FsbENoZWNrKGluc3RhbmNlLCBDb25zdHJ1Y3RvcikgeyBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkgeyB0aHJvdyBuZXcgVHlwZUVycm9yKCdDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb24nKTsgfSB9XG5cbnZhciBFeGFtcGxlMiA9IChmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIEV4YW1wbGUyKGRhdGEpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgRXhhbXBsZTIpO1xuXG4gICAgdGhpcy5iaW5kID0gbmV3IExpYWlzb24oZGF0YSk7XG4gICAgdGhpcy5iaW5kaW5nID0gbmV3IEJpbmRpbmcodGhpcy5iaW5kKTtcbiAgICAvLyB0aGlzLmFub3RoZXJGdW5jdGlvbigpXG4gIH1cblxuICBfY3JlYXRlQ2xhc3MoRXhhbXBsZTIsIFt7XG4gICAga2V5OiAnYW5vdGhlckZ1bmN0aW9uJyxcbiAgICB2YWx1ZTogZnVuY3Rpb24gYW5vdGhlckZ1bmN0aW9uKCkge1xuICAgICAgLy8gaGVyZSB5b3UgaGF2ZSBhY2Nlc3MgdG8gdGhpcy5kYXRhLnVzZXIgYW5kIHRoaXMuZGF0YS5wcm9ncmFtbWluZ19sYW5ndWFnZXNcbiAgICAgIGNvbnNvbGUubG9nKHRoaXMuYmluZC5zdHJpbmcpO1xuICAgIH1cbiAgfV0pO1xuXG4gIHJldHVybiBFeGFtcGxlMjtcbn0pKCk7XG4vLyBwdXRzIHJvdXRlcyBvbiB0aGUgcm91dGVyIGNsYXNzXG5cbid1c2Ugc3RyaWN0JztcblxuLy8gVE9ETzogbm90IGF0dGFjaCB0aGlzIHRvIHRoZSBnbG9iYWwgbmFtZXNwYWNlXG53aW5kb3cucm91dGVyID0gd2luZG93LnJvdXRlciB8fCBuZXcgUm91dGVyKCk7XG53aW5kb3cucm91dGVyLnN0YXRlKHtcbiAgbmFtZTogJy91c2VycycsXG4gIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL3VzZXJpbmRleC5odG1sJ1xufSkuc3RhdGUoe1xuICBuYW1lOiAnL3VzZXIvOmlkJyxcbiAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvdXNlci5odG1sJ1xufSkuc3RhdGUoe1xuICBuYW1lOiAnL3VzZXIvOmlkL2RldGFpbHMnLFxuICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy91c2VyZGV0YWlscy5odG1sJ1xufSkuc3RhdGUoe1xuICBuYW1lOiAnL3VzZXIvOmlkLzpzdWJpZCcsXG4gIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL3VzZXJzdWIuaHRtbCdcbn0pLnN0YXRlKHtcbiAgbmFtZTogJy9saXN0JyxcbiAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvbGlzdC5odG1sJ1xufSkuc3RhdGUoe1xuICBuYW1lOiAnLycsXG4gIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzL2xpc3QuaHRtbCdcbn0pLmZhbGxiYWNrKHtcbiAgbmFtZTogJy80MDQnLFxuICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy80MDQuaHRtbCdcbn0pO1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgX2NyZWF0ZUNsYXNzID0gKGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7IGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHsgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTsgZGVzY3JpcHRvci5lbnVtZXJhYmxlID0gZGVzY3JpcHRvci5lbnVtZXJhYmxlIHx8IGZhbHNlOyBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7IGlmICgndmFsdWUnIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlOyBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7IH0gfSByZXR1cm4gZnVuY3Rpb24gKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykgeyBpZiAocHJvdG9Qcm9wcykgZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpOyBpZiAoc3RhdGljUHJvcHMpIGRlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTsgcmV0dXJuIENvbnN0cnVjdG9yOyB9OyB9KSgpO1xuXG52YXIgX2dldCA9IGZ1bmN0aW9uIGdldChfeCwgX3gyLCBfeDMpIHsgdmFyIF9hZ2FpbiA9IHRydWU7IF9mdW5jdGlvbjogd2hpbGUgKF9hZ2FpbikgeyB2YXIgb2JqZWN0ID0gX3gsIHByb3BlcnR5ID0gX3gyLCByZWNlaXZlciA9IF94MzsgX2FnYWluID0gZmFsc2U7IGlmIChvYmplY3QgPT09IG51bGwpIG9iamVjdCA9IEZ1bmN0aW9uLnByb3RvdHlwZTsgdmFyIGRlc2MgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKG9iamVjdCwgcHJvcGVydHkpOyBpZiAoZGVzYyA9PT0gdW5kZWZpbmVkKSB7IHZhciBwYXJlbnQgPSBPYmplY3QuZ2V0UHJvdG90eXBlT2Yob2JqZWN0KTsgaWYgKHBhcmVudCA9PT0gbnVsbCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IGVsc2UgeyBfeCA9IHBhcmVudDsgX3gyID0gcHJvcGVydHk7IF94MyA9IHJlY2VpdmVyOyBfYWdhaW4gPSB0cnVlOyBkZXNjID0gcGFyZW50ID0gdW5kZWZpbmVkOyBjb250aW51ZSBfZnVuY3Rpb247IH0gfSBlbHNlIGlmICgndmFsdWUnIGluIGRlc2MpIHsgcmV0dXJuIGRlc2MudmFsdWU7IH0gZWxzZSB7IHZhciBnZXR0ZXIgPSBkZXNjLmdldDsgaWYgKGdldHRlciA9PT0gdW5kZWZpbmVkKSB7IHJldHVybiB1bmRlZmluZWQ7IH0gcmV0dXJuIGdldHRlci5jYWxsKHJlY2VpdmVyKTsgfSB9IH07XG5cbmZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHsgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignQ2Fubm90IGNhbGwgYSBjbGFzcyBhcyBhIGZ1bmN0aW9uJyk7IH0gfVxuXG5mdW5jdGlvbiBfaW5oZXJpdHMoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIHsgaWYgKHR5cGVvZiBzdXBlckNsYXNzICE9PSAnZnVuY3Rpb24nICYmIHN1cGVyQ2xhc3MgIT09IG51bGwpIHsgdGhyb3cgbmV3IFR5cGVFcnJvcignU3VwZXIgZXhwcmVzc2lvbiBtdXN0IGVpdGhlciBiZSBudWxsIG9yIGEgZnVuY3Rpb24sIG5vdCAnICsgdHlwZW9mIHN1cGVyQ2xhc3MpOyB9IHN1YkNsYXNzLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoc3VwZXJDbGFzcyAmJiBzdXBlckNsYXNzLnByb3RvdHlwZSwgeyBjb25zdHJ1Y3RvcjogeyB2YWx1ZTogc3ViQ2xhc3MsIGVudW1lcmFibGU6IGZhbHNlLCB3cml0YWJsZTogdHJ1ZSwgY29uZmlndXJhYmxlOiB0cnVlIH0gfSk7IGlmIChzdXBlckNsYXNzKSBPYmplY3Quc2V0UHJvdG90eXBlT2YgPyBPYmplY3Quc2V0UHJvdG90eXBlT2Yoc3ViQ2xhc3MsIHN1cGVyQ2xhc3MpIDogc3ViQ2xhc3MuX19wcm90b19fID0gc3VwZXJDbGFzczsgfVxuXG52YXIgVXNlck1vZGVsID0gKGZ1bmN0aW9uIChfQmFzZU1vZGVsKSB7XG4gIF9pbmhlcml0cyhVc2VyTW9kZWwsIF9CYXNlTW9kZWwpO1xuXG4gIGZ1bmN0aW9uIFVzZXJNb2RlbCgpIHtcbiAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVXNlck1vZGVsKTtcblxuICAgIF9nZXQoT2JqZWN0LmdldFByb3RvdHlwZU9mKFVzZXJNb2RlbC5wcm90b3R5cGUpLCAnY29uc3RydWN0b3InLCB0aGlzKS5jYWxsKHRoaXMsICd1c2VyJywge1xuICAgICAgaWQ6IHtcbiAgICAgICAgdmFsdWU6IDc4OTc4NyxcbiAgICAgICAgdHlwZTogJ251bWJlcidcbiAgICAgIH0sXG4gICAgICBuYW1lOiB7XG4gICAgICAgIHZhbHVlOiAnbmFtZScsXG4gICAgICAgIHR5cGU6ICdzdHJpbmcnXG4gICAgICB9LFxuICAgICAgYWRkcmVzczoge1xuICAgICAgICB2YWx1ZTogJzIyMWIgYmFrZScsXG4gICAgICAgIHR5cGU6ICdzdHJpbmcnXG4gICAgICB9LFxuICAgICAgYWdlOiB7XG4gICAgICAgIHZhbHVlOiBudWxsLFxuICAgICAgICB0eXBlOiAnbnVtYmVyJ1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgLy8gZXhhbXBsZSBtb2RlbCBoZWxwZXJcblxuICBfY3JlYXRlQ2xhc3MoVXNlck1vZGVsLCBbe1xuICAgIGtleTogJ3VwQ2FzZScsXG4gICAgdmFsdWU6IGZ1bmN0aW9uIHVwQ2FzZShzdHIpIHtcbiAgICAgIHJldHVybiBzdHIudG9VcHBlckNhc2UoKTtcbiAgICB9XG4gIH1dKTtcblxuICByZXR1cm4gVXNlck1vZGVsO1xufSkoQmFzZU1vZGVsKTtcbid1c2Ugc3RyaWN0JztcblxudmFyIF9nZXQgPSBmdW5jdGlvbiBnZXQoX3gsIF94MiwgX3gzKSB7IHZhciBfYWdhaW4gPSB0cnVlOyBfZnVuY3Rpb246IHdoaWxlIChfYWdhaW4pIHsgdmFyIG9iamVjdCA9IF94LCBwcm9wZXJ0eSA9IF94MiwgcmVjZWl2ZXIgPSBfeDM7IF9hZ2FpbiA9IGZhbHNlOyBpZiAob2JqZWN0ID09PSBudWxsKSBvYmplY3QgPSBGdW5jdGlvbi5wcm90b3R5cGU7IHZhciBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihvYmplY3QsIHByb3BlcnR5KTsgaWYgKGRlc2MgPT09IHVuZGVmaW5lZCkgeyB2YXIgcGFyZW50ID0gT2JqZWN0LmdldFByb3RvdHlwZU9mKG9iamVjdCk7IGlmIChwYXJlbnQgPT09IG51bGwpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSBlbHNlIHsgX3ggPSBwYXJlbnQ7IF94MiA9IHByb3BlcnR5OyBfeDMgPSByZWNlaXZlcjsgX2FnYWluID0gdHJ1ZTsgZGVzYyA9IHBhcmVudCA9IHVuZGVmaW5lZDsgY29udGludWUgX2Z1bmN0aW9uOyB9IH0gZWxzZSBpZiAoJ3ZhbHVlJyBpbiBkZXNjKSB7IHJldHVybiBkZXNjLnZhbHVlOyB9IGVsc2UgeyB2YXIgZ2V0dGVyID0gZGVzYy5nZXQ7IGlmIChnZXR0ZXIgPT09IHVuZGVmaW5lZCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IHJldHVybiBnZXR0ZXIuY2FsbChyZWNlaXZlcik7IH0gfSB9O1xuXG5mdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7IGlmICghKGluc3RhbmNlIGluc3RhbmNlb2YgQ29uc3RydWN0b3IpKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ0Nhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvbicpOyB9IH1cblxuZnVuY3Rpb24gX2luaGVyaXRzKHN1YkNsYXNzLCBzdXBlckNsYXNzKSB7IGlmICh0eXBlb2Ygc3VwZXJDbGFzcyAhPT0gJ2Z1bmN0aW9uJyAmJiBzdXBlckNsYXNzICE9PSBudWxsKSB7IHRocm93IG5ldyBUeXBlRXJyb3IoJ1N1cGVyIGV4cHJlc3Npb24gbXVzdCBlaXRoZXIgYmUgbnVsbCBvciBhIGZ1bmN0aW9uLCBub3QgJyArIHR5cGVvZiBzdXBlckNsYXNzKTsgfSBzdWJDbGFzcy5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKHN1cGVyQ2xhc3MgJiYgc3VwZXJDbGFzcy5wcm90b3R5cGUsIHsgY29uc3RydWN0b3I6IHsgdmFsdWU6IHN1YkNsYXNzLCBlbnVtZXJhYmxlOiBmYWxzZSwgd3JpdGFibGU6IHRydWUsIGNvbmZpZ3VyYWJsZTogdHJ1ZSB9IH0pOyBpZiAoc3VwZXJDbGFzcykgT2JqZWN0LnNldFByb3RvdHlwZU9mID8gT2JqZWN0LnNldFByb3RvdHlwZU9mKHN1YkNsYXNzLCBzdXBlckNsYXNzKSA6IHN1YkNsYXNzLl9fcHJvdG9fXyA9IHN1cGVyQ2xhc3M7IH1cblxudmFyIFZpZXdNb2RlbCA9IChmdW5jdGlvbiAoX0Jhc2VNb2RlbCkge1xuICBfaW5oZXJpdHMoVmlld01vZGVsLCBfQmFzZU1vZGVsKTtcblxuICBmdW5jdGlvbiBWaWV3TW9kZWwoKSB7XG4gICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFZpZXdNb2RlbCk7XG5cbiAgICBfZ2V0KE9iamVjdC5nZXRQcm90b3R5cGVPZihWaWV3TW9kZWwucHJvdG90eXBlKSwgJ2NvbnN0cnVjdG9yJywgdGhpcykuY2FsbCh0aGlzLCAndmlldycsIHtcbiAgICAgIHNpbmdsZToge1xuICAgICAgICB0eXBlOiAnc3RyaW5nJyxcbiAgICAgICAgdmFsdWU6ICdmcm9tIHNjaGVtYSdcbiAgICAgIH0sXG4gICAgICB1c2VyOiB7XG4gICAgICAgIHR5cGU6ICdvYmplY3QnLFxuICAgICAgICB2YWx1ZToge1xuICAgICAgICAgIGlkOiB7XG4gICAgICAgICAgICB0eXBlOiAnbnVtYmVyJyxcbiAgICAgICAgICAgIHZhbHVlOiA4ODg4OFxuICAgICAgICAgIH0sXG4gICAgICAgICAgbmFtZToge1xuICAgICAgICAgICAgdHlwZTogJ3N0cmluZycsXG4gICAgICAgICAgICB2YWx1ZTogJ1NoZXJsb2NrIEhvbG1lcydcbiAgICAgICAgICB9LFxuICAgICAgICAgIGFkZHJlc3M6IHtcbiAgICAgICAgICAgIHR5cGU6ICdzdHJpbmcnLFxuICAgICAgICAgICAgdmFsdWU6ICcyMjFiIEJha2VyIFN0cmVldCdcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBwcm9ncmFtbWluZ0xhbmd1YWdlczoge1xuICAgICAgICB0eXBlOiAnYXJyYXknLFxuICAgICAgICB2YWx1ZTogWydqYXZhc2NyaXB0JywgJ3J1YnknXVxuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgcmV0dXJuIFZpZXdNb2RlbDtcbn0pKEJhc2VNb2RlbCk7IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgTGlhaXNvbiB7XG4gIGNvbnN0cnVjdG9yKGRhdGEpIHtcbiAgICBmb3IgKGNvbnN0IGRhdHVtIGluIGRhdGEpIHtcbiAgICAgIGlmIChkYXR1bSkge1xuICAgICAgICB0aGlzW2RhdHVtXSA9IGRhdGFbZGF0dW1dO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gbG9hZENvbXBvbmVudChtb2R1bGUsIGRhdGEpIHtcbiAgcmV0dXJuIG5ldyB3aW5kb3dbbW9kdWxlXShkYXRhKTtcbn1cbiIsIi8vIFRPRE86IGFsbG93IGEgc2hhcmVkIGZyb250ZW5kL2JhY2tlbmQgc2NoZW1hIGZpbGVcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEJhc2VNb2RlbCB7XG4gIGNvbnN0cnVjdG9yKG1vZGVsTmFtZSwgc2NoZW1hKSB7XG4gICAgdGhpcy5tb2RlbE5hbWUgPSBtb2RlbE5hbWU7XG4gICAgdGhpcy5kYXRhID0gc2NoZW1hO1xuICB9XG5cbiAgc2V0KGtleSwgdmFsdWUpIHtcbiAgICBjb25zdCBleGlzdHNJblNjaGVtYSA9IHRoaXMuX2V4aXN0c0luU2NoZW1hKHRoaXMuZGF0YSwga2V5LCB2YWx1ZSk7XG4gICAgaWYgKCFleGlzdHNJblNjaGVtYSkge1xuICAgICAgY29uc29sZS53YXJuKGBOb3Qgc2V0dGluZyBcIiR7a2V5fVwiIGluICR7dGhpcy5tb2RlbE5hbWV9IG1vZGVsIHRvIFwiJHt2YWx1ZX1cIi4gRG9lc250IGV4aXN0IGluIHRoZSBzY2hlbWFgKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgdHlwZU1hdGNoZXMgPSB0aGlzLl9jaGVja1R5cGUodGhpcy5kYXRhLCBrZXksIHZhbHVlKTtcbiAgICBpZiAoIXR5cGVNYXRjaGVzKSB7XG4gICAgICBjb25zb2xlLndhcm4oYE5vdCBzZXR0aW5nIFwiJHtrZXl9XCIgaW4gJHt0aGlzLm1vZGVsTmFtZX0gbW9kZWwgdG8gXCIke3ZhbHVlfVwiLiBJdCBpc250IHRoZSByaWdodCB0eXBlYCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuX3NldFZhbHVlKHRoaXMuZGF0YSwga2V5LCB2YWx1ZSk7XG4gIH1cblxuICBnZXQoYWNjZXNzKSB7XG4gICAgbGV0IHJldHVyblZhbHVlO1xuICAgIGlmIChhY2Nlc3MpIHtcbiAgICAgIHJldHVyblZhbHVlID0gdGhpcy5fZ2V0VmFsdWUodGhpcy5kYXRhLCBhY2Nlc3MpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm5WYWx1ZSA9IHRoaXMuX2dldERhdGEodGhpcy5kYXRhKTtcbiAgICB9XG4gICAgcmV0dXJuIHJldHVyblZhbHVlO1xuICB9XG5cbiAgX2V4aXN0c0luU2NoZW1hKG9iaiwgYWNjZXNzLCB2YWx1ZSkge1xuICAgIGxldCByZXR1cm5WYWx1ZTtcbiAgICBjb25zdCBfYWNjZXNzID0gKHR5cGVvZihhY2Nlc3MpID09PSAnc3RyaW5nJykgPyBhY2Nlc3Muc3BsaXQoJy4nKSA6IGFjY2VzcztcbiAgICBpZiAoX2FjY2Vzcy5sZW5ndGggPiAxICYmIG9ialtfYWNjZXNzWzBdXSkge1xuICAgICAgcmV0dXJuVmFsdWUgPSB0aGlzLl9leGlzdHNJblNjaGVtYShvYmpbX2FjY2Vzcy5zaGlmdCgpXS52YWx1ZSwgX2FjY2VzcywgdmFsdWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm5WYWx1ZSA9IG9ialtfYWNjZXNzWzBdXSA/IHRydWUgOiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHJldHVyblZhbHVlO1xuICB9XG5cbiAgX2NoZWNrVHlwZShvYmosIGFjY2VzcywgdmFsdWUpIHtcbiAgICBsZXQgcmV0dXJuVmFsdWU7XG4gICAgY29uc3QgX2FjY2VzcyA9ICh0eXBlb2YoYWNjZXNzKSA9PT0gJ3N0cmluZycpID8gYWNjZXNzLnNwbGl0KCcuJykgOiBhY2Nlc3M7XG4gICAgaWYgKF9hY2Nlc3MubGVuZ3RoID4gMSAmJiBvYmpbX2FjY2Vzc1swXV0pIHtcbiAgICAgIHJldHVyblZhbHVlID0gdGhpcy5fY2hlY2tUeXBlKG9ialtfYWNjZXNzLnNoaWZ0KCldLnZhbHVlLCBfYWNjZXNzLCB2YWx1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVyblZhbHVlID0gb2JqW19hY2Nlc3NbMF1dLnR5cGUgPT09IHR5cGVvZiB2YWx1ZTtcbiAgICB9XG4gICAgcmV0dXJuIHJldHVyblZhbHVlO1xuICB9XG5cbiAgX2dldERhdGEob2JqLCBuZXdPYmogPSB7fSkge1xuICAgIGZvciAoY29uc3QgZWxlbWVudCBpbiBvYmopIHtcbiAgICAgIGlmIChvYmpbZWxlbWVudF0udHlwZSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgbmV3T2JqW2VsZW1lbnRdID0ge307XG4gICAgICAgIHRoaXMuX2dldERhdGEob2JqW2VsZW1lbnRdLnZhbHVlLCBuZXdPYmpbZWxlbWVudF0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbmV3T2JqW2VsZW1lbnRdID0gb2JqW2VsZW1lbnRdLnZhbHVlO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbmV3T2JqO1xuICB9XG5cbiAgX3NldFZhbHVlKG9iaiwgYWNjZXNzLCB2YWx1ZSkge1xuICAgIGNvbnN0IF9hY2Nlc3MgPSAodHlwZW9mKGFjY2VzcykgPT09ICdzdHJpbmcnKSA/IGFjY2Vzcy5zcGxpdCgnLicpIDogYWNjZXNzO1xuICAgIGlmIChfYWNjZXNzLmxlbmd0aCA+IDEgJiYgb2JqW19hY2Nlc3NbMF1dLnZhbHVlKSB7XG4gICAgICB0aGlzLl9zZXRWYWx1ZShvYmpbX2FjY2Vzcy5zaGlmdCgpXS52YWx1ZSwgX2FjY2VzcywgdmFsdWUpO1xuICAgIH0gZWxzZSBpZiAob2JqW19hY2Nlc3NbMF1dLnZhbHVlKSB7XG4gICAgICBvYmpbX2FjY2Vzc1swXV0udmFsdWUgPSB2YWx1ZTtcbiAgICB9XG4gIH1cblxuICBfZ2V0VmFsdWUob2JqLCBhY2Nlc3MpIHtcbiAgICBsZXQgcmV0dXJuVmFsdWU7XG4gICAgbGV0IF9hY2Nlc3MgPSBhY2Nlc3M7XG4gICAgX2FjY2VzcyA9ICh0eXBlb2YoYWNjZXNzKSA9PT0gJ3N0cmluZycpID8gX2FjY2Vzcy5zcGxpdCgnLicpIDogX2FjY2VzcztcbiAgICBpZiAoX2FjY2Vzcy5sZW5ndGggPiAxICYmIG9ialtfYWNjZXNzWzBdXSkge1xuICAgICAgcmV0dXJuVmFsdWUgPSB0aGlzLl9nZXRWYWx1ZShvYmpbX2FjY2Vzcy5zaGlmdCgpXS52YWx1ZSwgX2FjY2Vzcyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVyblZhbHVlID0gb2JqW19hY2Nlc3NbMF1dLnZhbHVlIHx8ICcnO1xuICAgIH1cbiAgICByZXR1cm4gcmV0dXJuVmFsdWU7XG4gIH1cblxuICBzZXQgZW5kcG9pbnRQcmVmaXgocHJlZml4KSB7XG4gICAgdGhpcy5fZW5kcG9pbnRQcmVmaXggPSBwcmVmaXg7XG4gIH1cblxuICBnZXQgZW5kcG9pbnRQcmVmaXgoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2VuZHBvaW50UHJlZml4IHx8ICdhcGkvdmknO1xuICB9XG5cbiAgLy8gVE9ETzogcmVmYWN0b3IgdGhpcyB0byBoZWxwZXJcbiAgX2NoZWNrU3RhdHVzKHJlc3BvbnNlKSB7XG4gICAgbGV0IHJldHVyblZhbHVlO1xuICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPj0gMjAwICYmIHJlc3BvbnNlLnN0YXR1cyA8IDMwMCkge1xuICAgICAgcmV0dXJuVmFsdWUgPSByZXNwb25zZTtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IocmVzcG9uc2Uuc3RhdHVzVGV4dCk7XG4gICAgICBlcnJvci5yZXNwb25zZSA9IHJlc3BvbnNlO1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICAgIHJldHVybiByZXR1cm5WYWx1ZTtcbiAgfVxuXG4gIF9wYXJzZUpTT04ocmVzcG9uc2UpIHtcbiAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpO1xuICB9XG5cbiAgLy8gVE9ETzogQ1JVRCBvcGVyYXRpb25zIHhociBjYWxscy4gcmV0dXJuIHByb21pc2VzXG4gIHNhdmUoaWQgPSB0aGlzLmdldCgnaWQnKSkge1xuICAgIGNvbnN0IHVybCA9IGAke3RoaXMuZW5kcG9pbnRQcmVmaXh9LyR7dGhpcy5tb2RlbE5hbWV9LyR7aWR9YDtcbiAgICBjb25zdCBzZW5kT2JqID0ge307XG4gICAgY29uc3QgeGhyUHJvcGVydGllcyA9IHtcbiAgICAgIG1ldGhvZDogJ3Bvc3QnLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoc2VuZE9iaiksXG4gICAgfTtcblxuICAgIHNlbmRPYmpbdGhpcy5tb2RlbE5hbWVdID0gdGhpcy5nZXQoKTtcbiAgICBjb25zb2xlLmxvZyhgbWFrZSBwb3N0IHhociBjYWxsIHRvICR7dXJsfWAsIHNlbmRPYmopO1xuXG4gICAgcmV0dXJuIGZldGNoKHVybCwgeGhyUHJvcGVydGllcylcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrU3RhdHVzKVxuICAgICAgLnRoZW4odGhpcy5fcGFyc2VKU09OKTtcbiAgfVxuXG4gIGZldGNoKGlkID0gdGhpcy5nZXQoJ2lkJykpIHtcbiAgICBjb25zdCB1cmwgPSBgJHt0aGlzLmVuZHBvaW50UHJlZml4fS8ke3RoaXMubW9kZWxOYW1lfS8ke2lkfWA7XG4gICAgY29uc3QgeGhyUHJvcGVydGllcyA9IHtcbiAgICAgIG1ldGhvZDogJ2dldCcsXG4gICAgfTtcbiAgICBjb25zb2xlLmxvZyhgbWFrZSBnZXQgeGhyIGNhbGwgdG8gJHt1cmx9YCk7XG5cbiAgICByZXR1cm4gZmV0Y2godXJsLCB4aHJQcm9wZXJ0aWVzKVxuICAgICAgLnRoZW4odGhpcy5fY2hlY2tTdGF0dXMpXG4gICAgICAudGhlbih0aGlzLl9wYXJzZUpTT04pO1xuICB9XG5cbiAgdXBkYXRlKGlkID0gdGhpcy5nZXQoJ2lkJykpIHtcbiAgICBjb25zdCB1cmwgPSBgJHt0aGlzLmVuZHBvaW50UHJlZml4fS8ke3RoaXMubW9kZWxOYW1lfS8ke2lkfWA7XG4gICAgY29uc3Qgc2VuZE9iaiA9IHt9O1xuICAgIHNlbmRPYmpbdGhpcy5tb2RlbE5hbWVdID0gdGhpcy5nZXQoKTtcbiAgICBjb25zb2xlLmxvZyhgbWFrZSB1cGRhdGUgeGhyIGNhbGwgdG8gJHt1cmx9YCwgc2VuZE9iaik7XG5cbiAgICAvLyBHaXRodWIncyBmZXRjaCBwcm9qZWN0IGRvZXNudCBhcHBlYXIgdG8gc3VwcG9ydCBVUERBVEVcbiAgICAvLyBUT0RPOiBpbnZlc3RpZ2F0ZSB0aGUgYWJvdmUgc3RhdGVtZW50XG4gICAgLy8gZmV0Y2godXJsLCB7XG4gICAgLy8gICBtZXRob2Q6ICdVUERBVEUnLFxuICAgIC8vICAgYm9keTogSlNPTi5zdHJpbmdpZnkoc2VuZE9iailcbiAgICAvLyB9KTtcbiAgfVxuXG4gIGRlc3Ryb3koaWQgPSB0aGlzLmdldCgnaWQnKSkge1xuICAgIGNvbnN0IHVybCA9IGAke3RoaXMuZW5kcG9pbnRQcmVmaXh9LyR7dGhpcy5tb2RlbE5hbWV9LyR7aWR9YDtcbiAgICBjb25zdCB4aHJQcm9wZXJ0aWVzID0ge1xuICAgICAgbWV0aG9kOiAnZGVsZXRlJyxcbiAgICB9O1xuICAgIGNvbnNvbGUubG9nKGBtYWtlIGRlbGV0ZSB4aHIgY2FsbCB0byAke3VybH1gKTtcblxuICAgIHJldHVybiBmZXRjaCh1cmwsIHhoclByb3BlcnRpZXMpXG4gICAgICAudGhlbih0aGlzLl9jaGVja1N0YXR1cylcbiAgICAgIC50aGVuKHRoaXMuX3BhcnNlSlNPTik7XG4gIH1cbn1cbiIsIi8vIGFsbG93aW5nIGZvci4ub2Ygb2Ygbm9kZWxpc3RzIGZvciBDaHJvbWUgc3VwcG9ydFxuTm9kZUxpc3QucHJvdG90eXBlW1N5bWJvbC5pdGVyYXRvcl0gPSBBcnJheS5wcm90b3R5cGVbU3ltYm9sLml0ZXJhdG9yXTtcbmltcG9ydCB7VXRpbHN9IGZyb20gJy4vVXRpbHMnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBCaW5kaW5nIHtcbiAgY29uc3RydWN0b3IoZGF0YSkge1xuICAgIHRoaXMuZGF0YSA9IGRhdGE7XG4gICAgdGhpcy5fZmluZEJpbmRhYmxlKCk7XG4gICAgdGhpcy51dGlscyA9IG5ldyBVdGlscygpO1xuXG4gICAgbGV0IGN1cnJlbnREYXRhID0gY3VycmVudERhdGEgfHwge307XG5cbiAgICAvLyB3YXRjaGluZyB0aGlzLmRhdGEgZm9yIHByb2dyYW1tYXRpY2FsIHVwZGF0ZXNcbiAgICBzZXRJbnRlcnZhbCgoKSA9PiB7XG4gICAgICBpZiAodGhpcy51dGlscy5jb21wYXJlKGN1cnJlbnREYXRhLCB0aGlzLmRhdGEpID09PSBmYWxzZSkge1xuICAgICAgICBjdXJyZW50RGF0YSA9IEpTT04ucGFyc2UoSlNPTi5zdHJpbmdpZnkodGhpcy5kYXRhKSk7XG4gICAgICAgIHRoaXMuX3BvcHVsYXRlQmluZGluZ3MoKTtcbiAgICAgIH1cbiAgICB9LCAxMCk7XG4gIH1cblxuICBfcG9wdWxhdGVCaW5kaW5ncygpIHtcbiAgICBmb3IgKGNvbnN0IGVsbSBvZiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCdbbGlhaXNvbi1iaW5kXScpKSB7XG4gICAgICBjb25zdCBiaW5kTmFtZSA9IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQuZ2V0QXR0cmlidXRlKCdsaWFpc29uLWJpbmQnKTtcblxuICAgICAgLy8gcHJldmVudCB0aGUgaW5wdXQgeW91cmUgdHlwaW5nIGluIGZyb20gdXBkYXRpbmcuIHByZXZlbnRzIHRoZSBjdXJzb3IgZnJvbSBqdW1waW5nIHRvIHRoZSBlbmRcbiAgICAgIC8vIG9ubHkgdXBkYXRlcyBiaW5kaW5ncyB0aGF0IG5lZWQgdG8gYmUgdXBkYXRlZFxuICAgICAgaWYgKGVsbSAhPT0gZG9jdW1lbnQuYWN0aXZlRWxlbWVudCAmJiAoZWxtLmdldEF0dHJpYnV0ZSgnbGlhaXNvbi1iaW5kJykgPT09IGJpbmROYW1lIHx8IGJpbmROYW1lID09PSBudWxsKSkge1xuICAgICAgICB0aGlzLl9zZXRFbGVtZW50Q29udGVudChlbG0sIHRoaXMuX2dldFZhbHVlKHRoaXMuZGF0YSwgZWxtLmdldEF0dHJpYnV0ZSgnbGlhaXNvbi1iaW5kJykpKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBfZmluZEJpbmRhYmxlKCkge1xuICAgIGZvciAoY29uc3QgZWxtIG9mIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ1tsaWFpc29uLWJpbmRdJykpIHtcbiAgICAgIGVsbS5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgKGV2ZW50KSA9PiB7XG4gICAgICAgIC8vIHNldHRpbWVvdXQgYWxsb3dzIHRoZSBrZXlkb3duIGV2ZW50IGdvIGdldCB0aGUgbmV3IHZhbHVlXG4gICAgICAgIHNldFRpbWVvdXQoKCkgPT4gdGhpcy5fc2V0VmFsdWUodGhpcy5kYXRhLCBlbG0uZ2V0QXR0cmlidXRlKCdsaWFpc29uLWJpbmQnKSwgZXZlbnQuc3JjRWxlbWVudC52YWx1ZSkpO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG5cbiAgX3NldEVsZW1lbnRDb250ZW50KGVsZW1lbnQsIHZhbHVlKSB7XG4gICAgLy8gYWxsb3dzIG11bHRpcGxlIGNvbXBvbmVudHNcbiAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkgcmV0dXJuO1xuICAgIGVsZW1lbnQuaW5uZXJIVE1MID0gdmFsdWU7XG4gICAgZWxlbWVudC52YWx1ZSA9IHZhbHVlO1xuICB9XG5cbiAgX3NldFZhbHVlKG9iaiwgYWNjZXNzLCB2YWx1ZSkge1xuICAgIGxldCBfYWNjZXNzID0gYWNjZXNzO1xuICAgIGlmICh0eXBlb2YoX2FjY2VzcykgPT09ICdzdHJpbmcnKSB7XG4gICAgICBfYWNjZXNzID0gX2FjY2Vzcy5zcGxpdCgnLicpO1xuICAgIH1cbiAgICBpZiAoX2FjY2Vzcy5sZW5ndGggPiAxICYmIG9ialtfYWNjZXNzWzBdXSkge1xuICAgICAgdGhpcy5fc2V0VmFsdWUob2JqW19hY2Nlc3Muc2hpZnQoKV0sIF9hY2Nlc3MsIHZhbHVlKTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBvYmpbX2FjY2Vzc1swXV0gPT09ICdzdHJpbmcnKSB7XG4gICAgICBvYmpbX2FjY2Vzc1swXV0gPSB2YWx1ZTtcbiAgICB9XG4gIH1cblxuICBfZ2V0VmFsdWUob2JqLCBhY2Nlc3MpIHtcbiAgICBsZXQgX2FjY2VzcyA9IGFjY2VzcztcbiAgICBsZXQgcmV0dXJuVmFsdWU7XG4gICAgaWYgKHR5cGVvZihfYWNjZXNzKSA9PT0gJ3N0cmluZycpIHtcbiAgICAgIF9hY2Nlc3MgPSBfYWNjZXNzLnNwbGl0KCcuJyk7XG4gICAgfVxuICAgIGlmIChfYWNjZXNzLmxlbmd0aCA+IDEgJiYgb2JqW19hY2Nlc3NbMF1dKSB7XG4gICAgICByZXR1cm5WYWx1ZSA9IHRoaXMuX2dldFZhbHVlKG9ialtfYWNjZXNzLnNoaWZ0KCldLCBfYWNjZXNzKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuVmFsdWUgPSBvYmpbX2FjY2Vzc1swXV07XG4gICAgfVxuICAgIHJldHVybiByZXR1cm5WYWx1ZTtcbiAgfVxuXG4gIHJlZnJlc2goZGF0YSkge1xuICAgIHRoaXMuZGF0YSA9IGRhdGE7XG4gICAgdGhpcy5fcG9wdWxhdGVCaW5kaW5ncygpO1xuICB9XG59XG4iLCJpbXBvcnQgVXRpbHMgZnJvbSAnLi9VdGlscyc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFJvdXRlciB7XG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMudXRpbHMgPSBuZXcgVXRpbHMoKTtcbiAgICB0aGlzLnZpZXcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdbbGlhaXNvbi12aWV3XScpO1xuICAgIHRoaXMucGF0aHMgPSBbXTtcbiAgICB0aGlzLndpbGRjYXJkcyA9IFtdO1xuICAgIC8vIGdvZXMgdG8gaGFzaCB1cmxcbiAgICBzZXRUaW1lb3V0KCgpID0+IHRoaXMuZ28od2luZG93LmxvY2F0aW9uLmhhc2guc3Vic3RyaW5nKDEpKSwgMCk7XG4gICAgLy8gYWxsb3dzIGJhY2svZm9yd2FyZCBidXR0b25zXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3BvcHN0YXRlJywgKGV2ZW50KSA9PiB0aGlzLmdvKGV2ZW50LnN0YXRlIHx8IHdpbmRvdy5sb2NhdGlvbi5oYXNoLnN1YnN0cmluZygxKSwgZmFsc2UpKTtcbiAgfVxuXG4gIHN0YXRlKGRhdGEpIHtcbiAgICBpZiAoZGF0YS5uYW1lLmluZGV4T2YoJzonKSA+IDApIHtcbiAgICAgIHRoaXMud2lsZGNhcmRzLnB1c2goZGF0YSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMucGF0aHMucHVzaChkYXRhKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICBmYWxsYmFjayhkYXRhKSB7XG4gICAgdGhpcy5wYXRocy5wdXNoKGRhdGEpO1xuICAgIHRoaXMuX2ZhbGxiYWNrID0gZGF0YTtcbiAgfVxuXG4gIC8vIGludGVncmF0aW9uIHRlc3RzIGNvdmVyIHRoaXNcbiAgZ28ocm91dGUpIHtcbiAgICBjb25zb2xlLmxvZyhgZ29pbmcgdG8gc3RhdGUgJHtyb3V0ZX1gKTtcbiAgICBjb25zdCBvYmogPSB0aGlzLl9maW5kUm91dGVJblBhdGhzKHJvdXRlKTtcbiAgICBpZiAoIW9iaikge1xuICAgICAgdGhpcy5nbyh0aGlzLl9mYWxsYmFjay5uYW1lKTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgZmV0Y2gob2JqLnRlbXBsYXRlVXJsKVxuICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7XG4gICAgICAgIHJldHVybiByZXNwb25zZS50ZXh0KCk7XG4gICAgICB9KVxuICAgICAgLnRoZW4oKHRlbXBsYXRlKSA9PiB7XG4gICAgICAgIHRoaXMudmlldy5pbm5lckhUTUwgPSB0ZW1wbGF0ZTtcbiAgICAgIH0pO1xuICB9XG5cbiAgLy8gVE9ETzogY2xlYW4gdGhpcyB1cC4gdGhlcmUgaGFzIHRvIGJlIGEgYmV0dGVyIHdheVxuICBfZmluZFJvdXRlSW5QYXRocyhyb3V0ZSkge1xuICAgIC8vIHNlYXJjaGluZyBmb3IgbmF0dXJhbCBwYXRoXG4gICAgZm9yIChjb25zdCBwYXRoIG9mIHRoaXMucGF0aHMpIHtcbiAgICAgIGlmIChwYXRoLm5hbWUgPT09IHJvdXRlKSByZXR1cm4gcGF0aDtcbiAgICB9XG5cbiAgICAvLyBubyBuYXR1cmFsIHBhdGggZm91bmQuIHNlYXJjaGluZyB3aWxkY2FyZHNcbiAgICBsZXQgcnRuO1xuICAgIGNvbnN0IF9yb3V0ZSA9IHRoaXMuX3BhcnNlUm91dGUocm91dGUpO1xuXG4gICAgLy8gZmlsdGVyIGJ5IHVybCBzZWN0aW9uc1xuICAgIHRoaXMud2lsZGNhcmRzLmZpbHRlcigod2lsZGNhcmQpID0+IHtcbiAgICAgIHJldHVybiB0aGlzLl9wYXJzZVJvdXRlKHdpbGRjYXJkLm5hbWUpLmxlbmd0aCA9PT0gX3JvdXRlLmxlbmd0aDsgLy8gZmlsdGVycyBieSBtYXRjaGluZyBsZW5ndGhzIGZpcnN0XG4gICAgfSkuZm9yRWFjaCgod2lsZGNhcmQpID0+IHtcbiAgICAgIGNvbnN0IF93aWxkY2FyZCA9IHRoaXMuX3BhcnNlUm91dGUod2lsZGNhcmQubmFtZSk7XG4gICAgICAvLyBpdGVyYXRpbmcgb3ZlciBlYWNoIGVsZW1lbnQgaW4gdGhlIHdpbGRjYXJkLiBpZSBbdXNlciwgOmlkLCA6c3ViaWRdXG4gICAgICBfd2lsZGNhcmQuZm9yRWFjaCgoZWxlbWVudCwgaW5kZXgpID0+IHtcbiAgICAgICAgaWYgKGVsZW1lbnQuaW5kZXhPZignOicpICE9PSAwKSByZXR1cm4gZmFsc2U7XG4gICAgICAgIC8vIHJlcGxhY2VzIHdpbGRjYXJkcyB3aXRoIGFjdHVhbCB2YWx1ZXMgc28gdGhleSBjYW4gYmUgY29tcGFyZWRcbiAgICAgICAgY29uc3QgdGVtcCA9IF93aWxkY2FyZDtcbiAgICAgICAgdGVtcFtpbmRleF0gPSBfcm91dGVbaW5kZXhdO1xuICAgICAgICBpZiAodGhpcy51dGlscy5jb21wYXJlKHRlbXAsIF9yb3V0ZSkpIHJ0biA9IHdpbGRjYXJkO1xuICAgICAgfSk7XG4gICAgfSk7XG4gICAgcmV0dXJuIHJ0bjtcbiAgfVxuXG4gIF9wYXJzZVJvdXRlKHJvdXRlKSB7XG4gICAgcmV0dXJuIHJvdXRlLnN1YnN0cmluZygxKS5zcGxpdCgnLycpO1xuICB9XG59XG5cbi8vICogb24gcGFnZSBsb2FkLCBnZXQgdXJsIGFuZCBsb2FkIGFwcHJvcHJpYXRlIHRlbXRwbGF0ZVxuLy8gKiBvbiB1cmwgY2hhbmdlLCB1cGRhdGUgdGVtcGxhdGVcbi8vICogYWxsb3cgd2lsZGNhcmRzIGluIHBhdGhzIC90ZW1wbGF0ZS91c2VyLzppZFxuLy8gcGFzcyB2YXJpYWJsZXMgdG8gdGVtcGxhdGVcbi8vIGFsbG93IGNvbXBvbmVudCB0byBiZSBkZWNsYXJlZCBpbiByb3V0ZSBvYmplY3Rcbi8vICogZ2V0IHN0YXRlIChpZiBzdGF0ZSA9PSAnaHVob2hvaGFvJykuLi5cbi8vICogdXBkYXRlIHN0YXRlIG9uIGZvcndhcmQvYmFja1xuLy8gKiByb3V0ZXMgb24gcmVmcmVzaFxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXRpbHMge1xuICBjb25zdHJ1Y3RvcigpIHt9XG5cbiAgX2hhc2hlcih2YWwpIHtcbiAgICBsZXQgaGFzaCA9IDA7XG4gICAgbGV0IGluZGV4O1xuICAgIGxldCBsZW47XG4gICAgY29uc3Qgc3RyaW5nID0gdmFsLnRvU3RyaW5nKCk7XG4gICAgZm9yIChpbmRleCA9IDAsIGxlbiA9IHN0cmluZy5sZW5ndGg7IGluZGV4IDwgbGVuOyBpbmRleCsrKSB7XG4gICAgICBoYXNoID0gKCgoaGFzaCA8PCA1KSAtIGhhc2gpICsgc3RyaW5nLmNoYXJDb2RlQXQoaW5kZXgpKSAmIDB4RkZGRkZGRkY7XG4gICAgfVxuICAgIHJldHVybiBoYXNoO1xuICB9XG5cbiAgX29iamVjdChzZWxmLCBvYmosIHJlc3VsdCA9IDApIHtcbiAgICBsZXQgX3Jlc3VsdCA9IHJlc3VsdDtcbiAgICBmb3IgKGNvbnN0IHByb3BlcnR5IGluIG9iaikge1xuICAgICAgaWYgKHR5cGVvZiBvYmpbcHJvcGVydHldID09PSAnb2JqZWN0Jykge1xuICAgICAgICByZXR1cm4gdGhpcy5fb2JqZWN0KHNlbGYsIG9ialtwcm9wZXJ0eV0sIF9yZXN1bHQpO1xuICAgICAgfVxuICAgICAgaWYgKGhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wZXJ0eSkpIHtcbiAgICAgICAgX3Jlc3VsdCArPSBzZWxmLl9oYXNoZXIocHJvcGVydHkgKyBzZWxmLl9oYXNoZXIob2JqW3Byb3BlcnR5XSkpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gX3Jlc3VsdDtcbiAgfVxuXG4gIGhhc2goaW5wdXQpIHtcbiAgICBjb25zdCB0eXBlcyA9IHtcbiAgICAgICdzdHJpbmcnOiB0aGlzLl9oYXNoZXIsXG4gICAgICAnbnVtYmVyJzogdGhpcy5faGFzaGVyLFxuICAgICAgJ2Jvb2xlYW4nOiB0aGlzLl9oYXNoZXIsXG4gICAgICAnb2JqZWN0JzogdGhpcy5vYmplY3QsXG4gICAgfTtcbiAgICBjb25zdCB0eXBlID0gdHlwZW9mIGlucHV0O1xuXG4gICAgcmV0dXJuIGlucHV0ICE9PSBudWxsICYmIHR5cGVzW3R5cGVdID8gdHlwZXNbdHlwZV0odGhpcywgaW5wdXQpICsgdGhpcy5faGFzaGVyKHR5cGUpIDogMDtcbiAgfVxuXG4gIGNvbXBhcmVIYXNoZXMoaXRlbUEsIGl0ZW1CKSB7XG4gICAgcmV0dXJuIHRoaXMuaGFzaChpdGVtQSkgPT09IHRoaXMuaGFzaChpdGVtQik7XG4gIH1cblxuICAvLyBmYXN0ZXIgdGhhbiBjb21wYXJlSGFzaGVzXG4gIGNvbXBhcmUoaXRlbUEsIGl0ZW1CKSB7XG4gICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KGl0ZW1BKSA9PT0gSlNPTi5zdHJpbmdpZnkoaXRlbUIpO1xuICB9XG59XG4iLCJpbXBvcnQgTGlhaXNvbiBmcm9tICcuL0xpYWlzb24nO1xuaW1wb3J0IEJpbmRpbmcgZnJvbSAnLi9CaW5kaW5nJztcbmltcG9ydCBVc2VyTW9kZWwgZnJvbSAnLi9Vc2VyTW9kZWwnO1xuaW1wb3J0IFZpZXdNb2RlbCBmcm9tICcuL1ZpZXdNb2RlbCc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEV4YW1wbGUge1xuICBjb25zdHJ1Y3RvcihkYXRhKSB7XG4gICAgdGhpcy5iaW5kID0gbmV3IExpYWlzb24oZGF0YSk7XG4gICAgY29uc29sZS5sb2codGhpcy5iaW5kKTtcbiAgICB0aGlzLmJpbmRpbmcgPSBuZXcgQmluZGluZyh0aGlzLmJpbmQpO1xuICAgIHRoaXMuZXhhbXBsZUJpbmRpbmcoKTtcbiAgICB0aGlzLmV4YW1wbGVSb3V0ZXIoKTtcbiAgfVxuXG4gIGV4YW1wbGVCaW5kaW5nKCkge1xuICAgIC8vIGhlcmUgeW91IGhhdmUgYWNjZXNzIHRvIHRoaXMuYmluZC51c2VyIGFuZCB0aGlzLmJpbmQucHJvZ3JhbW1pbmdfbGFuZ3VhZ2VzXG4gICAgLy8gY29uc29sZS5sb2codGhpcy5iaW5kLnVzZXIpO1xuICAgIC8vIGNvbnNvbGUubG9nKHRoaXMuYmluZC5wcm9ncmFtbWluZ19sYW5ndWFnZXMpO1xuXG4gICAgLy8gbW9kZWwgZXhhbXBsZXNcbiAgICBjb25zdCB1c2VyID0gbmV3IFVzZXJNb2RlbCgpO1xuICAgIHVzZXIuc2V0KCdhZ2UnLCAnODc3NycpOyAvLyBzaG91bGQgZmFpbFxuICAgIHVzZXIuc2V0KCduYW1lJywgJ215IGZpcnN0IG5hbWUgb24gdXNlciBtb2RlbCcpOyAvLyBzaG91bGQgcGFzc1xuICAgIHVzZXIuc2V0KCdhZ2UnLCB7XG4gICAgICBhZ2U6IDMzLFxuICAgIH0pOyAvLyBzaG91bGQgZmFpbFxuICAgIHVzZXIuc2V0KCdhZ2UnLCA5OTkpOyAvLyBzaG91bGQgcGFzc1xuICAgIHVzZXIuc2V0KCdhZGRyZXNzJywgJ215IGFkZHJlc3MnKTsgLy8gc2hvdWxkIHBhc3NcblxuICAgIC8vIHNldHMgZGF0YSBiaW5kaW5nXG4gICAgLy8gdGhpcy5iaW5kLnVzZXIubmFtZSA9IHVzZXIuZ2V0KCduYW1lJylcbiAgICB1c2VyLnNldCgnYWRkcmVzcycsIHVzZXIudXBDYXNlKCdteSBzZWNvbmQgYWRkcmVzcycpKTsgLy8gc2hvdWxkIHBhc3MgYW5kIHBvc3RmaXggXCIhXCIgdG8gdGhlIGFkZHJlc3NcblxuICAgIHVzZXIuc2F2ZSgpLnRoZW4oKCkgPT4ge1xuICAgICAgY29uc29sZS5sb2coJ3RoZW4nKTtcbiAgICB9KS5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKCdyZXF1ZXN0IGZhaWxlZCcsIGVycm9yKTtcbiAgICB9KTtcbiAgICB1c2VyLnVwZGF0ZSgpO1xuICAgIHVzZXIuZmV0Y2goKS50aGVuKCgpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKCd0aGVuJyk7XG4gICAgfSkuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZygncmVxdWVzdCBmYWlsZWQnLCBlcnJvcik7XG4gICAgfSk7XG4gICAgdXNlci5kZXN0cm95KCkudGhlbigoKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZygndGhlbicpO1xuICAgIH0pLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgY29uc29sZS5sb2coJ3JlcXVlc3QgZmFpbGVkJywgZXJyb3IpO1xuICAgIH0pO1xuXG4gICAgLy8gc2Vjb25kIG1vZGVsXG4gICAgY29uc3Qgdmlld21vZGVsID0gbmV3IFZpZXdNb2RlbCgpO1xuICAgIC8vIHNob3VsZCBwYXNzXG4gICAgdmlld21vZGVsLnNldCgnc2luZ2xlJywgJ3VwZGF0ZWQgdmlhIHZpZXdtb2RlbCBtb2RlbCBzZXQgZnVuY3Rpb24nKTtcbiAgICAvLyBzaG91bGQgcGFzc1xuICAgIHZpZXdtb2RlbC5zZXQoJ3VzZXIubmFtZScsICdteSBzZWNvbmQgZXhhbXBsZSBuYW1lJyk7XG4gICAgLy8gc2hvdWxkIGZhaWxcbiAgICB2aWV3bW9kZWwuc2V0KCd1c2VyLmFnZScsIHtcbiAgICAgIGFnZTogMjIsXG4gICAgfSk7XG4gICAgLy8gc2hvdWxkIGZhaWxcbiAgICB2aWV3bW9kZWwuc2V0KCd1c2VyLmFnZScsIDQ0NCk7XG4gICAgLy8gc2hvdWxkIGZhaWxcbiAgICB2aWV3bW9kZWwuc2V0KCd1c2VyLmFkZHJlc3MnLCA3Nzg3OCk7XG4gICAgLy8gc2hvdWxkIHBhc3NcbiAgICB2aWV3bW9kZWwuc2V0KCd1c2VyLmFkZHJlc3MnLCAnbXkgc2Vjb25kIGFkZHJlc3MnKTtcblxuICAgIC8vIHNldHMgZGF0YSBiaW5kaW5nXG4gICAgLy8gdGhpcy5iaW5kID0gdmlld21vZGVsLmdldCgpXG4gICAgLy8gdGhpcy5iaW5kLnVzZXIgPSB1c2VyLmdldCgpXG4gICAgdGhpcy5iaW5kaW5nLnJlZnJlc2godGhpcy5iaW5kKTtcbiAgfVxuXG4gIGV4YW1wbGVSb3V0ZXIoKSB7XG4gICAgLy8gY2hhbmdlIHN0YXRlIHRvIC9saXN0XG4gICAgLy8gcm91dGVyLmdvKCdob2Rvci8xMicsIHtteWRhdGE6MTIzNDU1NiwgbXlvYmo6e25hbWU6J3NoZXJsb2NrJ319KTtcbiAgICAvLyBzZXRUaW1lb3V0KCgpPT4gd2luZG93LnJvdXRlci5nbygnbGlzdCcpLDIwMDApXG4gIH1cbn1cbiIsImltcG9ydCBMaWFpc29uIGZyb20gJy4vTGlhaXNvbic7XG5pbXBvcnQgQmluZGluZyBmcm9tICcuL0JpbmRpbmcnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBFeGFtcGxlMiB7XG4gIGNvbnN0cnVjdG9yKGRhdGEpIHtcbiAgICB0aGlzLmJpbmQgPSBuZXcgTGlhaXNvbihkYXRhKTtcbiAgICB0aGlzLmJpbmRpbmcgPSBuZXcgQmluZGluZyh0aGlzLmJpbmQpO1xuICAgICAgLy8gdGhpcy5hbm90aGVyRnVuY3Rpb24oKVxuICB9XG5cbiAgYW5vdGhlckZ1bmN0aW9uKCkge1xuICAgIC8vIGhlcmUgeW91IGhhdmUgYWNjZXNzIHRvIHRoaXMuZGF0YS51c2VyIGFuZCB0aGlzLmRhdGEucHJvZ3JhbW1pbmdfbGFuZ3VhZ2VzXG4gICAgY29uc29sZS5sb2codGhpcy5iaW5kLnN0cmluZyk7XG4gIH1cbn1cbiIsIi8vIHB1dHMgcm91dGVzIG9uIHRoZSByb3V0ZXIgY2xhc3NcblxuaW1wb3J0IFJvdXRlciBmcm9tICcuL1JvdXRlcic7XG4vLyBUT0RPOiBub3QgYXR0YWNoIHRoaXMgdG8gdGhlIGdsb2JhbCBuYW1lc3BhY2VcbndpbmRvdy5yb3V0ZXIgPSB3aW5kb3cucm91dGVyIHx8IG5ldyBSb3V0ZXIoKTtcbndpbmRvdy5yb3V0ZXIuc3RhdGUoe1xuICBuYW1lOiAnL3VzZXJzJyxcbiAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvdXNlcmluZGV4Lmh0bWwnLFxufSkuc3RhdGUoe1xuICBuYW1lOiAnL3VzZXIvOmlkJyxcbiAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvdXNlci5odG1sJyxcbn0pLnN0YXRlKHtcbiAgbmFtZTogJy91c2VyLzppZC9kZXRhaWxzJyxcbiAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvdXNlcmRldGFpbHMuaHRtbCcsXG59KS5zdGF0ZSh7XG4gIG5hbWU6ICcvdXNlci86aWQvOnN1YmlkJyxcbiAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvdXNlcnN1Yi5odG1sJyxcbn0pLnN0YXRlKHtcbiAgbmFtZTogJy9saXN0JyxcbiAgdGVtcGxhdGVVcmw6ICd0ZW1wbGF0ZXMvbGlzdC5odG1sJyxcbn0pLnN0YXRlKHtcbiAgbmFtZTogJy8nLFxuICB0ZW1wbGF0ZVVybDogJ3RlbXBsYXRlcy9saXN0Lmh0bWwnLFxufSkuZmFsbGJhY2soe1xuICBuYW1lOiAnLzQwNCcsXG4gIHRlbXBsYXRlVXJsOiAndGVtcGxhdGVzLzQwNC5odG1sJyxcbn0pO1xuIiwiaW1wb3J0IEJhc2VNb2RlbCBmcm9tICcuL0Jhc2VNb2RlbCc7XG5cbmV4cG9ydCBjbGFzcyBVc2VyTW9kZWwgZXh0ZW5kcyBCYXNlTW9kZWwge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcigndXNlcicsIHtcbiAgICAgIGlkOiB7XG4gICAgICAgIHZhbHVlOiA3ODk3ODcsXG4gICAgICAgIHR5cGU6ICdudW1iZXInLFxuICAgICAgfSxcbiAgICAgIG5hbWU6IHtcbiAgICAgICAgdmFsdWU6ICduYW1lJyxcbiAgICAgICAgdHlwZTogJ3N0cmluZycsXG4gICAgICB9LFxuICAgICAgYWRkcmVzczoge1xuICAgICAgICB2YWx1ZTogJzIyMWIgYmFrZScsXG4gICAgICAgIHR5cGU6ICdzdHJpbmcnLFxuICAgICAgfSxcbiAgICAgIGFnZToge1xuICAgICAgICB2YWx1ZTogbnVsbCxcbiAgICAgICAgdHlwZTogJ251bWJlcicsXG4gICAgICB9LFxuICAgIH0pO1xuICB9XG5cbiAgLy8gZXhhbXBsZSBtb2RlbCBoZWxwZXJcbiAgdXBDYXNlKHN0cikge1xuICAgIHJldHVybiBzdHIudG9VcHBlckNhc2UoKTtcbiAgfVxufVxuIiwiaW1wb3J0IEJhc2VNb2RlbCBmcm9tICcuL0Jhc2VNb2RlbCc7XG5cbmV4cG9ydCBjbGFzcyBWaWV3TW9kZWwgZXh0ZW5kcyBCYXNlTW9kZWwge1xuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcigndmlldycsIHtcbiAgICAgIHNpbmdsZToge1xuICAgICAgICB0eXBlOiAnc3RyaW5nJyxcbiAgICAgICAgdmFsdWU6ICdmcm9tIHNjaGVtYScsXG4gICAgICB9LFxuICAgICAgdXNlcjoge1xuICAgICAgICB0eXBlOiAnb2JqZWN0JyxcbiAgICAgICAgdmFsdWU6IHtcbiAgICAgICAgICBpZDoge1xuICAgICAgICAgICAgdHlwZTogJ251bWJlcicsXG4gICAgICAgICAgICB2YWx1ZTogODg4ODgsXG4gICAgICAgICAgfSxcbiAgICAgICAgICBuYW1lOiB7XG4gICAgICAgICAgICB0eXBlOiAnc3RyaW5nJyxcbiAgICAgICAgICAgIHZhbHVlOiAnU2hlcmxvY2sgSG9sbWVzJyxcbiAgICAgICAgICB9LFxuICAgICAgICAgIGFkZHJlc3M6IHtcbiAgICAgICAgICAgIHR5cGU6ICdzdHJpbmcnLFxuICAgICAgICAgICAgdmFsdWU6ICcyMjFiIEJha2VyIFN0cmVldCcsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICBwcm9ncmFtbWluZ0xhbmd1YWdlczoge1xuICAgICAgICB0eXBlOiAnYXJyYXknLFxuICAgICAgICB2YWx1ZTogWydqYXZhc2NyaXB0JywgJ3J1YnknXSxcbiAgICAgIH0sXG4gICAgfSk7XG4gIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
